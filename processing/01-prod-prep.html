<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Andreas Laffert">
<meta name="dcterms.date" content="2025-12-11">
<title>Data preparation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="01-prod-prep_files/libs/clipboard/clipboard.min.js"></script>
<script src="01-prod-prep_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="01-prod-prep_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="01-prod-prep_files/libs/quarto-html/popper.min.js"></script>
<script src="01-prod-prep_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="01-prod-prep_files/libs/quarto-html/anchor.min.js"></script>
<link href="01-prod-prep_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="01-prod-prep_files/libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="01-prod-prep_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="01-prod-prep_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="01-prod-prep_files/libs/bootstrap/bootstrap-c0b5e3d04d438fe040e43d1795624ea9.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
</head>
<body class="quarto-light">

<header id="title-block-header" class="quarto-title-block default page-columns page-full"><div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Data preparation</h1>
            <p class="subtitle lead">Housing wealth and social cohesion: Evidence from Chile</p>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Andreas Laffert </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">December 11, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2"><h2 id="toc-title">Contents</h2>
   
  <ul class="collapse">
<li><a href="#presentation" id="toc-presentation" class="nav-link active" data-scroll-target="#presentation"><span class="header-section-number">1</span> Presentation</a></li>
  <li><a href="#libraries" id="toc-libraries" class="nav-link" data-scroll-target="#libraries"><span class="header-section-number">2</span> Libraries</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data"><span class="header-section-number">3</span> Data</a></li>
  <li>
<a href="#processing" id="toc-processing" class="nav-link" data-scroll-target="#processing"><span class="header-section-number">4</span> Processing</a>
  <ul class="collapse">
<li><a href="#select" id="toc-select" class="nav-link" data-scroll-target="#select"><span class="header-section-number">4.1</span> Select</a></li>
  <li><a href="#filter" id="toc-filter" class="nav-link" data-scroll-target="#filter"><span class="header-section-number">4.2</span> Filter</a></li>
  <li><a href="#recode-and-transform" id="toc-recode-and-transform" class="nav-link" data-scroll-target="#recode-and-transform"><span class="header-section-number">4.3</span> Recode and transform</a></li>
  <li><a href="#missing-values" id="toc-missing-values" class="nav-link" data-scroll-target="#missing-values"><span class="header-section-number">4.4</span> Missing values</a></li>
  </ul>
</li>
  <li><a href="#merge-data-sets" id="toc-merge-data-sets" class="nav-link" data-scroll-target="#merge-data-sets"><span class="header-section-number">5</span> Merge data sets</a></li>
  <li><a href="#save-and-export" id="toc-save-and-export" class="nav-link" data-scroll-target="#save-and-export"><span class="header-section-number">6</span> Save and export</a></li>
  </ul></nav>
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content"><section id="presentation" class="level1" data-number="1"><h1 data-number="1">
<span class="header-section-number">1</span> Presentation</h1>
<p>This is the data preparation code for the paper “Housing wealth and social cohesion: Evidence from Chile”. The prepared dataset is <code>ELSOC_Long_2016_2023_1.00.RData</code> and other georeferenced data sources on housing values.</p>
</section><section id="libraries" class="level1" data-number="2"><h1 data-number="2">
<span class="header-section-number">2</span> Libraries</h1>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span> <span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="st"><a href="https://github.com/trinker/pacman">"pacman"</a></span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"pacman"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">tidyverse</span>,</span>
<span>               <span class="va">car</span>,</span>
<span>               <span class="va">sjmisc</span>, </span>
<span>               <span class="va">here</span>,</span>
<span>               <span class="va">sjlabelled</span>,</span>
<span>               <span class="va">SciViews</span>,</span>
<span>               <span class="va">naniar</span>,</span>
<span>               <span class="va">haven</span>,</span>
<span>               <span class="va">rio</span>,</span>
<span>               <span class="va">shadowtext</span>,</span>
<span>               <span class="va">ggdist</span>,</span>
<span>               <span class="va">rvest</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>scipen<span class="op">=</span><span class="fl">999</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="data" class="level1" data-number="3"><h1 data-number="3">
<span class="header-section-number">3</span> Data</h1>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/connections.html">url</a></span><span class="op">(</span><span class="st">"https://dataverse.harvard.edu/api/access/datafile/10797987"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">geo_elsoc</span> <span class="op">&lt;-</span> <span class="fu">rio</span><span class="fu">::</span><span class="fu"><a href="http://gesistsa.github.io/rio/reference/import.html">import</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"input/data/geo_elsoc.dta"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">precios_suelo</span> <span class="op">&lt;-</span> <span class="fu">rio</span><span class="fu">::</span><span class="fu"><a href="http://gesistsa.github.io/rio/reference/import.html">import</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"input/data/precios_suelo.dta"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">glimpse</span><span class="op">(</span><span class="va">elsoc_long_2016_2023</span><span class="op">)</span></span>
<span><span class="fu">glimpse</span><span class="op">(</span><span class="va">geo_elsoc</span><span class="op">)</span></span>
<span><span class="fu">glimpse</span><span class="op">(</span><span class="va">precios_suelo</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="processing" class="level1" data-number="4"><h1 data-number="4">
<span class="header-section-number">4</span> Processing</h1>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># General NA's</span></span>
<span><span class="va">elsoc_long_2016_2023</span><span class="op">[</span><span class="va">elsoc_long_2016_2023</span> <span class="op">==</span><span class="op">-</span><span class="fl">999</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">elsoc_long_2016_2023</span><span class="op">[</span><span class="va">elsoc_long_2016_2023</span> <span class="op">==</span><span class="op">-</span><span class="fl">888</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">elsoc_long_2016_2023</span><span class="op">[</span><span class="va">elsoc_long_2016_2023</span> <span class="op">==</span><span class="op">-</span><span class="fl">777</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">elsoc_long_2016_2023</span><span class="op">[</span><span class="va">elsoc_long_2016_2023</span> <span class="op">==</span><span class="op">-</span><span class="fl">666</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="select" class="level2" data-number="4.1"><h2 data-number="4.1" class="anchored" data-anchor-id="select">
<span class="header-section-number">4.1</span> Select</h2>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">db</span> <span class="op">&lt;-</span> <span class="va">elsoc_long_2016_2023</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">idencuesta</span>, </span>
<span>         <span class="va">ola</span>, </span>
<span>         <span class="va">tipo_atricion</span>,</span>
<span>         <span class="va">muestra</span>,</span>
<span>         <span class="va">segmento</span>,</span>
<span>         <span class="va">estrato</span>,</span>
<span>         <span class="va">ponderador_long_total</span>,</span>
<span>         <span class="va">ponderador01</span>,</span>
<span>         <span class="va">ponderador02</span>,</span>
<span>         <span class="va">comuna</span>, </span>
<span>         <span class="va">comuna_cod</span>,</span>
<span>         <span class="va">region</span>,</span>
<span>         <span class="va">region_cod</span>,</span>
<span>         <span class="va">m0_sexo</span>,</span>
<span>         <span class="va">m0_edad</span>,</span>
<span>         <span class="va">m01</span>,</span>
<span>         <span class="va">nhogar1</span>,</span>
<span>         <span class="va">m46_nhogar</span>,</span>
<span>         <span class="va">m54</span>, </span>
<span>         <span class="va">m30</span>, </span>
<span>         <span class="va">m30b</span>, </span>
<span>         <span class="va">m29</span>, </span>
<span>         <span class="va">m33</span></span>
<span>         <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="filter" class="level2" data-number="4.2"><h2 data-number="4.2" class="anchored" data-anchor-id="filter">
<span class="header-section-number">4.2</span> Filter</h2>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">db</span> <span class="op">&lt;-</span> <span class="va">db</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">region_cod</span> <span class="op">==</span> <span class="fl">13</span><span class="op">)</span> <span class="co"># keep only region metropolitana</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="recode-and-transform" class="level2" data-number="4.3"><h2 data-number="4.3" class="anchored" data-anchor-id="recode-and-transform">
<span class="header-section-number">4.3</span> Recode and transform</h2>
<section id="wave" class="level3" data-number="4.3.1"><h3 data-number="4.3.1" class="anchored" data-anchor-id="wave">
<span class="header-section-number">4.3.1</span> Wave</h3>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">frq</span><span class="op">(</span><span class="va">db</span><span class="op">$</span><span class="va">ola</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Identificador de ola de encuesta (x) &lt;numeric&gt; 
# total N=6091 valid N=6091 mean=3.89 sd=1.95

Value | Label |    N | Raw % | Valid % | Cum. %
-----------------------------------------------
    1 |  2016 |  914 | 15.01 |   15.01 |  15.01
    2 |  2017 |  762 | 12.51 |   12.51 |  27.52
    3 |  2018 | 1090 | 17.90 |   17.90 |  45.41
    4 |  2019 |  985 | 16.17 |   16.17 |  61.58
    5 |  2021 |  775 | 12.72 |   12.72 |  74.31
    6 |  2022 |  800 | 13.13 |   13.13 |  87.44
    7 |  2023 |  765 | 12.56 |   12.56 | 100.00
 &lt;NA&gt; |  &lt;NA&gt; |    0 |  0.00 |    &lt;NA&gt; |   &lt;NA&gt;</code></pre>
</div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">db</span> <span class="op">&lt;-</span> <span class="va">db</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>ola <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span><span class="va">ola</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="st">"2016"</span>,</span>
<span>                         <span class="va">ola</span> <span class="op">==</span> <span class="fl">2</span> <span class="op">~</span> <span class="st">"2017"</span>,</span>
<span>                         <span class="va">ola</span> <span class="op">==</span> <span class="fl">3</span> <span class="op">~</span> <span class="st">"2018"</span>,</span>
<span>                         <span class="va">ola</span> <span class="op">==</span> <span class="fl">4</span> <span class="op">~</span> <span class="st">"2019"</span>,</span>
<span>                         <span class="va">ola</span> <span class="op">==</span> <span class="fl">5</span> <span class="op">~</span> <span class="st">"2021"</span>,</span>
<span>                         <span class="va">ola</span> <span class="op">==</span> <span class="fl">6</span> <span class="op">~</span> <span class="st">"2022"</span>,</span>
<span>                         <span class="va">ola</span> <span class="op">==</span> <span class="fl">7</span> <span class="op">~</span> <span class="st">"2023"</span><span class="op">)</span>,</span>
<span>         ola <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">ola</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"2016"</span>,</span>
<span>                                      <span class="st">"2017"</span>,</span>
<span>                                      <span class="st">"2018"</span>,</span>
<span>                                      <span class="st">"2019"</span>,</span>
<span>                                      <span class="st">"2021"</span>,</span>
<span>                                      <span class="st">"2022"</span>,</span>
<span>                                      <span class="st">"2023"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="sex" class="level3" data-number="4.3.2"><h3 data-number="4.3.2" class="anchored" data-anchor-id="sex">
<span class="header-section-number">4.3.2</span> Sex</h3>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">frq</span><span class="op">(</span><span class="va">db</span><span class="op">$</span><span class="va">m0_sexo</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sexo del entrevistado (x) &lt;numeric&gt; 
# total N=6091 valid N=6091 mean=1.63 sd=0.48

Value |  Label |    N | Raw % | Valid % | Cum. %
------------------------------------------------
    1 | Hombre | 2255 | 37.02 |   37.02 |  37.02
    2 |  Mujer | 3836 | 62.98 |   62.98 | 100.00
 &lt;NA&gt; |   &lt;NA&gt; |    0 |  0.00 |    &lt;NA&gt; |   &lt;NA&gt;</code></pre>
</div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">db</span><span class="op">$</span><span class="va">sex</span> <span class="op">&lt;-</span> <span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/recode.html">recode</a></span><span class="op">(</span><span class="va">db</span><span class="op">$</span><span class="va">m0_sexo</span>, </span>
<span>                      recodes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1='Male'; 2='Female'"</span><span class="op">)</span>, </span>
<span>                      levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Male"</span>, <span class="st">"Female"</span><span class="op">)</span>,</span>
<span>                      as.factor <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="va">db</span><span class="op">$</span><span class="va">sex</span> <span class="op">&lt;-</span> <span class="fu">sjlabelled</span><span class="fu">::</span><span class="fu"><a href="https://strengejacke.github.io/sjlabelled/reference/set_label.html">set_label</a></span><span class="op">(</span><span class="va">db</span><span class="op">$</span><span class="va">sex</span>, label <span class="op">=</span> <span class="st">"Sex"</span><span class="op">)</span></span>
<span><span class="fu">frq</span><span class="op">(</span><span class="va">db</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sex (x) &lt;categorical&gt; 
# total N=6091 valid N=6091 mean=1.63 sd=0.48

Value  |    N | Raw % | Valid % | Cum. %
----------------------------------------
Male   | 2255 | 37.02 |   37.02 |  37.02
Female | 3836 | 62.98 |   62.98 | 100.00
&lt;NA&gt;   |    0 |  0.00 |    &lt;NA&gt; |   &lt;NA&gt;</code></pre>
</div>
</div>
</section><section id="age" class="level3" data-number="4.3.3"><h3 data-number="4.3.3" class="anchored" data-anchor-id="age">
<span class="header-section-number">4.3.3</span> Age</h3>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">frq</span><span class="op">(</span><span class="va">db</span><span class="op">$</span><span class="va">m0_edad</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Edad del entrevistado (x) &lt;numeric&gt; 
# total N=6091 valid N=6091 mean=47.95 sd=15.39

Value |   N | Raw % | Valid % | Cum. %
--------------------------------------
   18 |  15 |  0.25 |    0.25 |   0.25
   19 |  26 |  0.43 |    0.43 |   0.67
   20 |  39 |  0.64 |    0.64 |   1.31
   21 |  63 |  1.03 |    1.03 |   2.35
   22 |  72 |  1.18 |    1.18 |   3.53
   23 |  70 |  1.15 |    1.15 |   4.68
   24 |  87 |  1.43 |    1.43 |   6.11
   25 | 102 |  1.67 |    1.67 |   7.78
   26 |  91 |  1.49 |    1.49 |   9.28
   27 |  98 |  1.61 |    1.61 |  10.88
   28 |  99 |  1.63 |    1.63 |  12.51
   29 |  89 |  1.46 |    1.46 |  13.97
   30 | 126 |  2.07 |    2.07 |  16.04
   31 | 107 |  1.76 |    1.76 |  17.80
   32 | 125 |  2.05 |    2.05 |  19.85
   33 | 126 |  2.07 |    2.07 |  21.92
   34 | 122 |  2.00 |    2.00 |  23.92
   35 | 115 |  1.89 |    1.89 |  25.81
   36 | 138 |  2.27 |    2.27 |  28.07
   37 | 116 |  1.90 |    1.90 |  29.98
   38 | 128 |  2.10 |    2.10 |  32.08
   39 | 105 |  1.72 |    1.72 |  33.80
   40 | 123 |  2.02 |    2.02 |  35.82
   41 | 105 |  1.72 |    1.72 |  37.55
   42 | 109 |  1.79 |    1.79 |  39.34
   43 |  93 |  1.53 |    1.53 |  40.86
   44 | 115 |  1.89 |    1.89 |  42.75
   45 | 105 |  1.72 |    1.72 |  44.48
   46 | 115 |  1.89 |    1.89 |  46.36
   47 | 118 |  1.94 |    1.94 |  48.30
   48 | 130 |  2.13 |    2.13 |  50.44
   49 | 113 |  1.86 |    1.86 |  52.29
   50 | 122 |  2.00 |    2.00 |  54.29
   51 | 111 |  1.82 |    1.82 |  56.12
   52 | 132 |  2.17 |    2.17 |  58.28
   53 | 121 |  1.99 |    1.99 |  60.27
   54 | 122 |  2.00 |    2.00 |  62.27
   55 | 146 |  2.40 |    2.40 |  64.67
   56 | 142 |  2.33 |    2.33 |  67.00
   57 | 139 |  2.28 |    2.28 |  69.28
   58 | 150 |  2.46 |    2.46 |  71.75
   59 | 149 |  2.45 |    2.45 |  74.19
   60 | 138 |  2.27 |    2.27 |  76.46
   61 | 114 |  1.87 |    1.87 |  78.33
   62 | 111 |  1.82 |    1.82 |  80.15
   63 | 124 |  2.04 |    2.04 |  82.19
   64 | 107 |  1.76 |    1.76 |  83.94
   65 | 105 |  1.72 |    1.72 |  85.67
   66 |  98 |  1.61 |    1.61 |  87.28
   67 |  97 |  1.59 |    1.59 |  88.87
   68 |  63 |  1.03 |    1.03 |  89.90
   69 |  65 |  1.07 |    1.07 |  90.97
   70 |  74 |  1.21 |    1.21 |  92.19
   71 |  75 |  1.23 |    1.23 |  93.42
   72 |  60 |  0.99 |    0.99 |  94.40
   73 |  55 |  0.90 |    0.90 |  95.30
   74 |  59 |  0.97 |    0.97 |  96.27
   75 |  57 |  0.94 |    0.94 |  97.21
   76 |  44 |  0.72 |    0.72 |  97.93
   77 |  39 |  0.64 |    0.64 |  98.57
   78 |  20 |  0.33 |    0.33 |  98.90
   79 |  24 |  0.39 |    0.39 |  99.29
   80 |  17 |  0.28 |    0.28 |  99.57
   81 |  11 |  0.18 |    0.18 |  99.75
   82 |   6 |  0.10 |    0.10 |  99.85
   83 |   3 |  0.05 |    0.05 |  99.90
   84 |   3 |  0.05 |    0.05 |  99.95
   85 |   1 |  0.02 |    0.02 |  99.97
   86 |   1 |  0.02 |    0.02 |  99.98
   90 |   1 |  0.02 |    0.02 | 100.00
 &lt;NA&gt; |   0 |  0.00 |    &lt;NA&gt; |   &lt;NA&gt;</code></pre>
</div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">db</span><span class="op">$</span><span class="va">age</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">db</span><span class="op">$</span><span class="va">m0_edad</span><span class="op">)</span></span>
<span></span>
<span><span class="va">db</span><span class="op">$</span><span class="va">age_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/recode.html">recode</a></span><span class="op">(</span><span class="va">db</span><span class="op">$</span><span class="va">age</span>, </span>
<span>                     <span class="st">"18:29=1;30:49=2;50:64=3;65:150=4"</span><span class="op">)</span>,</span>
<span>         labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'18-29'</span>, <span class="st">'30-49'</span>, <span class="st">'50-64'</span>, <span class="st">'65 or more'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">db</span><span class="op">$</span><span class="va">age</span> <span class="op">&lt;-</span> <span class="fu">sjlabelled</span><span class="fu">::</span><span class="fu"><a href="https://strengejacke.github.io/sjlabelled/reference/set_label.html">set_label</a></span><span class="op">(</span><span class="va">db</span><span class="op">$</span><span class="va">age</span>, </span>
<span>                                  label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Age"</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">db</span><span class="op">$</span><span class="va">age_t</span> <span class="op">&lt;-</span> <span class="fu">sjlabelled</span><span class="fu">::</span><span class="fu"><a href="https://strengejacke.github.io/sjlabelled/reference/set_label.html">set_label</a></span><span class="op">(</span><span class="va">db</span><span class="op">$</span><span class="va">age_t</span>, </span>
<span>                        label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Age groups"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="fu">frq</span><span class="op">(</span><span class="va">db</span><span class="op">$</span><span class="va">age_t</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Age groups (x) &lt;categorical&gt; 
# total N=6091 valid N=6091 mean=2.50 sd=0.92

Value      |    N | Raw % | Valid % | Cum. %
--------------------------------------------
18-29      |  851 | 13.97 |   13.97 |  13.97
30-49      | 2334 | 38.32 |   38.32 |  52.29
50-64      | 1928 | 31.65 |   31.65 |  83.94
65 or more |  978 | 16.06 |   16.06 | 100.00
&lt;NA&gt;       |    0 |  0.00 |    &lt;NA&gt; |   &lt;NA&gt;</code></pre>
</div>
</div>
</section><section id="education" class="level3" data-number="4.3.4"><h3 data-number="4.3.4" class="anchored" data-anchor-id="education">
<span class="header-section-number">4.3.4</span> Education</h3>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">frq</span><span class="op">(</span><span class="va">db</span><span class="op">$</span><span class="va">m01</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Nivel educacional (x) &lt;numeric&gt; 
# total N=6091 valid N=6085 mean=5.48 sd=2.28

Value |                                       Label |    N | Raw % | Valid % | Cum. %
-------------------------------------------------------------------------------------
 -999 |                                 No Responde |    0 |  0.00 |    0.00 |   0.00
 -888 |                                     No Sabe |    0 |  0.00 |    0.00 |   0.00
 -777 |             Valor perdido por error tecnico |    0 |  0.00 |    0.00 |   0.00
 -666 |       Valor perdido por encuesta incompleta |    0 |  0.00 |    0.00 |   0.00
    1 |                                Sin estudios |   44 |  0.72 |    0.72 |   0.72
    2 |  Educacion Basica o Preparatoria incompleta |  659 | 10.82 |   10.83 |  11.55
    3 |    Educacion Basica o Preparatoria completa |  540 |  8.87 |    8.87 |  20.43
    4 |    Educacion Media o Humanidades incompleta |  818 | 13.43 |   13.44 |  33.87
    5 |      Educacion Media o Humanidades completa | 1622 | 26.63 |   26.66 |  60.53
    6 |                 Tecnica Superior incompleta |  232 |  3.81 |    3.81 |  64.34
    7 |                   Tecnica Superior completa |  846 | 13.89 |   13.90 |  78.24
    8 |                    Universitaria incompleta |  396 |  6.50 |    6.51 |  84.75
    9 |                      Universitaria completa |  761 | 12.49 |   12.51 |  97.26
   10 | Estudios de posgrado (magister o doctorado) |  167 |  2.74 |    2.74 | 100.00
 &lt;NA&gt; |                                        &lt;NA&gt; |    6 |  0.10 |    &lt;NA&gt; |   &lt;NA&gt;</code></pre>
</div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">db</span> <span class="op">&lt;-</span> <span class="va">db</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>cine <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span><span class="va">m01</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Primary or less"</span>,</span>
<span>                          <span class="va">m01</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Secondary"</span>,</span>
<span>                          <span class="va">m01</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">7</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Technical"</span>,</span>
<span>                          <span class="va">m01</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">8</span>,<span class="fl">9</span>,<span class="fl">10</span><span class="op">)</span> <span class="op">~</span> <span class="st">"University or more"</span>,</span>
<span>                          <span class="cn">TRUE</span> <span class="op">~</span> <span class="cn">NA_character_</span><span class="op">)</span>,</span>
<span>         cine <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cine</span>, </span>
<span>                       levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Primary or less"</span>,</span>
<span>                                  <span class="st">"Secondary"</span>,</span>
<span>                                  <span class="st">"Technical"</span>,</span>
<span>                                  <span class="st">"University or more"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">db</span><span class="op">$</span><span class="va">cine</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">sjlabelled</span><span class="fu">::</span><span class="fu"><a href="https://strengejacke.github.io/sjlabelled/reference/set_label.html">set_label</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">db</span><span class="op">$</span><span class="va">cine</span>,</span>
<span>                        label <span class="op">=</span> <span class="st">"Education (CINE)"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">frq</span><span class="op">(</span><span class="va">db</span><span class="op">$</span><span class="va">cine</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Education (CINE) (x) &lt;categorical&gt; 
# total N=6091 valid N=6085 mean=2.41 sd=1.04

Value              |    N | Raw % | Valid % | Cum. %
----------------------------------------------------
Primary or less    | 1243 | 20.41 |   20.43 |  20.43
Secondary          | 2440 | 40.06 |   40.10 |  60.53
Technical          | 1078 | 17.70 |   17.72 |  78.24
University or more | 1324 | 21.74 |   21.76 | 100.00
&lt;NA&gt;               |    6 |  0.10 |    &lt;NA&gt; |   &lt;NA&gt;</code></pre>
</div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">db</span><span class="op">$</span><span class="va">educ_dic</span> <span class="op">&lt;-</span> <span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/recode.html">recode</a></span><span class="op">(</span><span class="va">db</span><span class="op">$</span><span class="va">m01</span>,</span>
<span>                           <span class="st">"c(1,2,3,4,5,6,7)=1;c(8,9,10)=2; c(-888,-999)=NA"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">db</span><span class="op">$</span><span class="va">educ_dic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">db</span><span class="op">$</span><span class="va">educ_dic</span>,</span>
<span>                      labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Less than Universitary"</span>,<span class="st">"Universitary"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">db</span><span class="op">$</span><span class="va">educ_dic</span> <span class="op">&lt;-</span>  <span class="fu">sjlabelled</span><span class="fu">::</span><span class="fu"><a href="https://strengejacke.github.io/sjlabelled/reference/set_label.html">set_label</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">db</span><span class="op">$</span><span class="va">educ_dic</span>,</span>
<span>                                      label <span class="op">=</span> <span class="st">"Education (dichotomized)"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">frq</span><span class="op">(</span><span class="va">db</span><span class="op">$</span><span class="va">educ_dic</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Education (dichotomized) (x) &lt;categorical&gt; 
# total N=6091 valid N=6085 mean=1.22 sd=0.41

Value                  |    N | Raw % | Valid % | Cum. %
--------------------------------------------------------
Less than Universitary | 4761 | 78.16 |   78.24 |  78.24
Universitary           | 1324 | 21.74 |   21.76 | 100.00
&lt;NA&gt;                   |    6 |  0.10 |    &lt;NA&gt; |   &lt;NA&gt;</code></pre>
</div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Recoding of education to years based on casen 2017.</span></span>
<span></span>
<span><span class="va">db</span><span class="op">$</span><span class="va">educyear</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/recode.html">recode</a></span><span class="op">(</span><span class="va">db</span><span class="op">$</span><span class="va">m01</span>, </span>
<span>              <span class="st">"1=0;2=4.3;3=7.5;4=9.8;5=12.02;6=13.9;</span></span>
<span><span class="st">               7=14.8;8=14.9;9=16.9;10=19.07;c(-888,-999)=NA"</span>, </span>
<span>              as.numeric <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">db</span><span class="op">$</span><span class="va">educyear</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">sjlabelled</span><span class="fu">::</span><span class="fu"><a href="https://strengejacke.github.io/sjlabelled/reference/set_label.html">set_label</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">db</span><span class="op">$</span><span class="va">educyear</span>,</span>
<span>                        label <span class="op">=</span> <span class="st">"Education in years"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">frq</span><span class="op">(</span><span class="va">db</span><span class="op">$</span><span class="va">educyear</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Education in years (x) &lt;numeric&gt; 
# total N=6091 valid N=6085 mean=11.85 sd=4.00

Value |    N | Raw % | Valid % | Cum. %
---------------------------------------
 0.00 |   44 |  0.72 |    0.72 |   0.72
 4.30 |  659 | 10.82 |   10.83 |  11.55
 7.50 |  540 |  8.87 |    8.87 |  20.43
 9.80 |  818 | 13.43 |   13.44 |  33.87
12.02 | 1622 | 26.63 |   26.66 |  60.53
13.90 |  232 |  3.81 |    3.81 |  64.34
14.80 |  846 | 13.89 |   13.90 |  78.24
14.90 |  396 |  6.50 |    6.51 |  84.75
16.90 |  761 | 12.49 |   12.51 |  97.26
19.07 |  167 |  2.74 |    2.74 | 100.00
 &lt;NA&gt; |    6 |  0.10 |    &lt;NA&gt; |   &lt;NA&gt;</code></pre>
</div>
</div>
</section><section id="income" class="level3" data-number="4.3.5"><h3 data-number="4.3.5" class="anchored" data-anchor-id="income">
<span class="header-section-number">4.3.5</span> Income</h3>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Impute midpoint of income ranges</span></span>
<span><span class="va">db</span><span class="op">$</span><span class="va">m30_rec</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/recode.html">recode</a></span><span class="op">(</span><span class="va">db</span><span class="op">$</span><span class="va">m30</span>,</span>
<span>                         <span class="st">"1=110000;2=251000;3=305000;4=355000;5=400000;</span></span>
<span><span class="st">            6=445000;7=490000;8=535000;9=585000;10=640000;11=700000;12=765000;</span></span>
<span><span class="st">            13=845000;14=935000;15=1040000;16=1180000;17=1375000;18=1670000;</span></span>
<span><span class="st">            19=2275000;20=2700000;NA=NA;c(-888,-999)=NA"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Impute midpoint of income ranges (2021)</span></span>
<span><span class="va">db</span><span class="op">$</span><span class="va">m30b_rec</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/recode.html">recode</a></span><span class="op">(</span><span class="va">db</span><span class="op">$</span><span class="va">m30b</span>,</span>
<span>                         <span class="st">"1=125000;2=300000;3=400000;4=575000;5=700000;NA=NA;c(-888,-999)=NA"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">sjmisc</span><span class="fu">::</span><span class="fu"><a href="https://strengejacke.github.io/sjmisc/reference/frq.html">frq</a></span><span class="op">(</span><span class="va">db</span><span class="op">$</span><span class="va">m30_rec</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>x &lt;numeric&gt; 
# total N=6091 valid N=1215 mean=928795.06 sd=713291.97

  Value |    N | Raw % | Valid % | Cum. %
-----------------------------------------
 110000 |   69 |  1.13 |    5.68 |   5.68
 251000 |   46 |  0.76 |    3.79 |   9.47
 305000 |   59 |  0.97 |    4.86 |  14.32
 355000 |   49 |  0.80 |    4.03 |  18.35
 400000 |   69 |  1.13 |    5.68 |  24.03
 445000 |   51 |  0.84 |    4.20 |  28.23
 490000 |   84 |  1.38 |    6.91 |  35.14
 535000 |   46 |  0.76 |    3.79 |  38.93
 585000 |   85 |  1.40 |    7.00 |  45.93
 640000 |   43 |  0.71 |    3.54 |  49.47
 700000 |   63 |  1.03 |    5.19 |  54.65
 765000 |   66 |  1.08 |    5.43 |  60.08
 845000 |   38 |  0.62 |    3.13 |  63.21
 935000 |   40 |  0.66 |    3.29 |  66.50
1040000 |   83 |  1.36 |    6.83 |  73.33
1180000 |   49 |  0.80 |    4.03 |  77.37
1375000 |   44 |  0.72 |    3.62 |  80.99
1670000 |   78 |  1.28 |    6.42 |  87.41
2275000 |   74 |  1.21 |    6.09 |  93.50
2700000 |   79 |  1.30 |    6.50 | 100.00
   &lt;NA&gt; | 4876 | 80.05 |    &lt;NA&gt; |   &lt;NA&gt;</code></pre>
</div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">sjmisc</span><span class="fu">::</span><span class="fu"><a href="https://strengejacke.github.io/sjmisc/reference/frq.html">frq</a></span><span class="op">(</span><span class="va">db</span><span class="op">$</span><span class="va">m30b_rec</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>x &lt;numeric&gt; 
# total N=6091 valid N=54 mean=335648.15 sd=187057.77

 Value |    N | Raw % | Valid % | Cum. %
----------------------------------------
125000 |   17 |  0.28 |   31.48 |  31.48
300000 |   13 |  0.21 |   24.07 |  55.56
400000 |   14 |  0.23 |   25.93 |  81.48
575000 |    4 |  0.07 |    7.41 |  88.89
700000 |    6 |  0.10 |   11.11 | 100.00
  &lt;NA&gt; | 6037 | 99.11 |    &lt;NA&gt; |   &lt;NA&gt;</code></pre>
</div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Recode DK/DA of Income to NA</span></span>
<span><span class="va">db</span><span class="op">$</span><span class="va">m29_rec</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/recode.html">recode</a></span><span class="op">(</span><span class="va">db</span><span class="op">$</span><span class="va">m29</span>,<span class="st">"c(-888,-999)=NA"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#replace NA of income with new imputed variable</span></span>
<span><span class="va">db</span><span class="op">$</span><span class="va">m29_imp</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span>test <span class="op">=</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">db</span><span class="op">$</span><span class="va">m29_rec</span><span class="op">)</span>,</span>
<span>         yes <span class="op">=</span>  <span class="va">db</span><span class="op">$</span><span class="va">m29_rec</span>,</span>
<span>         no <span class="op">=</span>  <span class="va">db</span><span class="op">$</span><span class="va">m30_rec</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">db</span><span class="op">$</span><span class="va">m29_imp</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Min.    1st Qu.     Median       Mean    3rd Qu.       Max.       NA's 
         0     380000     600000    1587995    1000000 4000000000        222 </code></pre>
</div>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">db</span><span class="op">$</span><span class="va">m29_imp</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span>test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">db</span><span class="op">$</span><span class="va">m29_imp</span><span class="op">)</span>,</span>
<span>         yes <span class="op">=</span>  <span class="va">db</span><span class="op">$</span><span class="va">m30b_rec</span>,</span>
<span>         no <span class="op">=</span>  <span class="va">db</span><span class="op">$</span><span class="va">m29_imp</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">db</span><span class="op">$</span><span class="va">m29_imp</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Min.    1st Qu.     Median       Mean    3rd Qu.       Max.       NA's 
         0     380000     600000    1576578    1000000 4000000000        168 </code></pre>
</div>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># deflate at each year's prices</span></span>
<span></span>
<span><span class="va">url</span> <span class="op">&lt;-</span> <span class="st">"https://si3.bcentral.cl/Siete/ES/Siete/Cuadro/CAP_PRECIOS/MN_CAP_PRECIOS/IPC_EMP_2023/638415285164039007?cbFechaInicio=2016&amp;cbFechaTermino=2025&amp;cbFrecuencia=MONTHLY&amp;cbCalculo=NONE&amp;cbFechaBase="</span></span>
<span></span>
<span><span class="va">ipc</span> <span class="op">&lt;-</span> <span class="va">url</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">read_html</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">html_node</span><span class="op">(</span><span class="st">"table"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">html_table</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">rename_with</span><span class="op">(</span><span class="va">.</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html">tolower</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"."</span>, <span class="st">"_"</span>, <span class="va">.x</span>, fixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">serie</span> <span class="op">==</span> <span class="st">"Índice IPC General"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    <span class="fu">across</span><span class="op">(</span></span>
<span>      .cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu">everything</span><span class="op">(</span><span class="op">)</span>, <span class="op">-</span><span class="va">serie</span><span class="op">)</span>,</span>
<span>      .fns <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu">str_replace</span><span class="op">(</span><span class="va">.</span>, <span class="st">","</span>, <span class="st">"."</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">sel_</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span><span class="va">.</span>, cols <span class="op">=</span> <span class="op">-</span><span class="va">serie</span>,</span>
<span>               names_to <span class="op">=</span> <span class="st">"ano_mes"</span>,</span>
<span>               values_to <span class="op">=</span> <span class="st">"ipc"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html">separate</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"ano_mes"</span>, into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"mes"</span>, <span class="st">"ano"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ipc</span> <span class="op">&lt;-</span> <span class="va">ipc</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">mes</span> <span class="op">==</span> <span class="st">"dic"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">ano</span>, <span class="va">ipc</span><span class="op">)</span></span>
<span></span>
<span><span class="va">db</span> <span class="op">&lt;-</span> <span class="fu">left_join</span><span class="op">(</span><span class="va">db</span>, <span class="va">ipc</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ola"</span> <span class="op">=</span> <span class="st">"ano"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">frq</span><span class="op">(</span><span class="va">db</span><span class="op">$</span><span class="va">ipc</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>x &lt;numeric&gt; 
# total N=6091 valid N=6091 mean=82.72 sd=10.45

 Value |    N | Raw % | Valid % | Cum. %
----------------------------------------
 72.29 |  914 | 15.01 |   15.01 |  15.01
 73.93 |  762 | 12.51 |   12.51 |  27.52
 75.83 | 1090 | 17.90 |   17.90 |  45.41
 78.10 |  985 | 16.17 |   16.17 |  61.58
 86.20 |  775 | 12.72 |   12.72 |  74.31
 97.21 |  800 | 13.13 |   13.13 |  87.44
101.04 |  765 | 12.56 |   12.56 | 100.00
  &lt;NA&gt; |    0 |  0.00 |    &lt;NA&gt; |   &lt;NA&gt;</code></pre>
</div>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Reshape long to wide</span></span>
<span><span class="va">db_wide</span> <span class="op">&lt;-</span> <span class="va">db</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span>id_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"idencuesta"</span>,<span class="st">"muestra"</span><span class="op">)</span>,</span>
<span>                     names_from <span class="op">=</span> <span class="st">"ola"</span>,</span>
<span>                     values_from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="fu">select</span><span class="op">(</span><span class="va">db</span>, <span class="va">tipo_atricion</span>, <span class="va">segmento</span><span class="op">:</span><span class="va">ipc</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">db_wide</span><span class="op">$</span><span class="va">m54_2022</span> <span class="op">&lt;-</span> <span class="va">db_wide</span><span class="op">$</span><span class="va">m54_2023</span></span>
<span></span>
<span><span class="co"># reshape from long to wide</span></span>
<span><span class="va">db_long</span> <span class="op">&lt;-</span> <span class="va">db_wide</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">idencuesta</span>, <span class="va">muestra</span><span class="op">)</span>,</span>
<span>    names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">".value"</span>, <span class="st">"ola"</span><span class="op">)</span>,</span>
<span>    <span class="co"># Toma TODO lo que va antes del último "_" como nombre de variable,</span></span>
<span>    <span class="co"># y lo que va después como la ola (1..7)</span></span>
<span>    names_pattern <span class="op">=</span> <span class="st">"^(.*)_(\\d+)$"</span>,</span>
<span>    values_drop_na <span class="op">=</span> <span class="cn">T</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>ola <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="va">ola</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">db_long</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">db_long</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>n_hogar <span class="op">=</span></span>
<span>           <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span><span class="va">ola</span> <span class="op">==</span> <span class="fl">2016</span> <span class="op">~</span> <span class="va">nhogar1</span>,</span>
<span>                            <span class="va">ola</span> <span class="op">==</span> <span class="fl">2017</span> <span class="op">~</span> <span class="va">m46_nhogar</span>,</span>
<span>                            <span class="va">ola</span> <span class="op">==</span> <span class="fl">2018</span> <span class="op">~</span> <span class="va">m54</span>,</span>
<span>                            <span class="va">ola</span> <span class="op">==</span> <span class="fl">2019</span> <span class="op">~</span> <span class="va">m54</span>,</span>
<span>                            <span class="va">ola</span> <span class="op">==</span> <span class="fl">2021</span> <span class="op">~</span> <span class="va">m54</span>,</span>
<span>                            <span class="va">ola</span> <span class="op">==</span> <span class="fl">2022</span> <span class="op">~</span> <span class="va">m54</span>,</span>
<span>                            <span class="va">ola</span> <span class="op">==</span> <span class="fl">2023</span> <span class="op">~</span> <span class="va">m54</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">sjmisc</span><span class="fu">::</span><span class="fu"><a href="https://strengejacke.github.io/sjmisc/reference/frq.html">frq</a></span><span class="op">(</span><span class="va">db_long</span><span class="op">$</span><span class="va">n_hogar</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>x &lt;numeric&gt; 
# total N=6204 valid N=5992 mean=3.32 sd=1.70

Value |    N | Raw % | Valid % | Cum. %
---------------------------------------
    1 |  760 | 12.25 |   12.68 |  12.68
    2 | 1384 | 22.31 |   23.10 |  35.78
    3 | 1328 | 21.41 |   22.16 |  57.94
    4 | 1266 | 20.41 |   21.13 |  79.07
    5 |  697 | 11.23 |   11.63 |  90.70
    6 |  305 |  4.92 |    5.09 |  95.79
    7 |  130 |  2.10 |    2.17 |  97.96
    8 |   65 |  1.05 |    1.08 |  99.05
    9 |   22 |  0.35 |    0.37 |  99.42
   10 |   18 |  0.29 |    0.30 |  99.72
   11 |    8 |  0.13 |    0.13 |  99.85
   12 |    6 |  0.10 |    0.10 |  99.95
   13 |    1 |  0.02 |    0.02 |  99.97
   14 |    1 |  0.02 |    0.02 |  99.98
   15 |    1 |  0.02 |    0.02 | 100.00
 &lt;NA&gt; |  212 |  3.42 |    &lt;NA&gt; |   &lt;NA&gt;</code></pre>
</div>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Recode DK/DA to NA</span></span>
<span><span class="va">db_long</span><span class="op">$</span><span class="va">n_hogar_r</span><span class="op">&lt;-</span></span>
<span>  <span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/recode.html">recode</a></span><span class="op">(</span><span class="va">db_long</span><span class="op">$</span><span class="va">n_hogar</span>,<span class="st">"c(-888,-999)=NA"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Per capita household income:</span></span>
<span><span class="va">db_long</span><span class="op">$</span><span class="va">ing_pc</span> <span class="op">&lt;-</span> </span>
<span>  <span class="op">(</span><span class="va">db_long</span><span class="op">$</span><span class="va">m29_imp</span><span class="op">/</span><span class="va">db_long</span><span class="op">$</span><span class="va">n_hogar_r</span><span class="op">)</span></span>
<span></span>
<span><span class="va">db_long</span><span class="op">$</span><span class="va">ing_pc</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">sjlabelled</span><span class="fu">::</span><span class="fu"><a href="https://strengejacke.github.io/sjlabelled/reference/set_label.html">set_label</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">db_long</span><span class="op">$</span><span class="va">ing_pc</span>,</span>
<span>                        label <span class="op">=</span> <span class="st">"Per capita household income"</span><span class="op">)</span>  </span>
<span></span>
<span><span class="fu">sjmisc</span><span class="fu">::</span><span class="fu"><a href="https://strengejacke.github.io/sjmisc/reference/descr.html">descr</a></span><span class="op">(</span><span class="va">db_long</span><span class="op">$</span><span class="va">ing_pc</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
## Basic descriptive statistics

 var    type                       label    n NA.prc     mean       sd     se
  dd numeric Per capita household income 5721   7.79 692046.3 26450210 349698
     md  trimmed                     range      iqr  skew
 200000 241779.9 2000000000 (0-2000000000) 253333.3 75.53</code></pre>
</div>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Compute income deciles: </span></span>
<span><span class="va">db_long</span> <span class="op">&lt;-</span> <span class="va">db_long</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">ola</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    decile <span class="op">=</span> <span class="fu">ntile</span><span class="op">(</span><span class="va">ing_pc</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">frq</span><span class="op">(</span><span class="va">db_long</span><span class="op">$</span><span class="va">decile</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>x &lt;integer&gt; 
# total N=6204 valid N=5721 mean=5.49 sd=2.87

Value |   N | Raw % | Valid % | Cum. %
--------------------------------------
    1 | 576 |  9.28 |   10.07 |  10.07
    2 | 576 |  9.28 |   10.07 |  20.14
    3 | 574 |  9.25 |   10.03 |  30.17
    4 | 573 |  9.24 |   10.02 |  40.19
    5 | 571 |  9.20 |    9.98 |  50.17
    6 | 571 |  9.20 |    9.98 |  60.15
    7 | 570 |  9.19 |    9.96 |  70.11
    8 | 570 |  9.19 |    9.96 |  80.07
    9 | 570 |  9.19 |    9.96 |  90.04
   10 | 570 |  9.19 |    9.96 | 100.00
 &lt;NA&gt; | 483 |  7.79 |    &lt;NA&gt; |   &lt;NA&gt;</code></pre>
</div>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">db_long</span><span class="op">$</span><span class="va">decile</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">sjlabelled</span><span class="fu">::</span><span class="fu"><a href="https://strengejacke.github.io/sjlabelled/reference/set_label.html">set_label</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">db_long</span><span class="op">$</span><span class="va">decile</span>,</span>
<span>                        label <span class="op">=</span> <span class="st">"Income decile"</span><span class="op">)</span>  </span>
<span></span>
<span><span class="co"># Include missing cases for income groups</span></span>
<span><span class="va">db_long</span><span class="op">$</span><span class="va">decile1</span> <span class="op">&lt;-</span> <span class="fu">if_else</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">db_long</span><span class="op">$</span><span class="va">decile</span><span class="op">)</span>, <span class="st">"DNA"</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">db_long</span><span class="op">$</span><span class="va">decile</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">db_long</span><span class="op">$</span><span class="va">decile1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">db_long</span><span class="op">$</span><span class="va">decile1</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>, <span class="st">"4"</span>, <span class="st">"5"</span>, <span class="st">"6"</span>, <span class="st">"7"</span>, <span class="st">"8"</span>, <span class="st">"9"</span>, <span class="st">"10"</span>, <span class="st">"DNA"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">db_long</span><span class="op">$</span><span class="va">decile1</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">sjlabelled</span><span class="fu">::</span><span class="fu"><a href="https://strengejacke.github.io/sjlabelled/reference/set_label.html">set_label</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">db_long</span><span class="op">$</span><span class="va">decile1</span>,</span>
<span>                        label <span class="op">=</span> <span class="st">"Income decile with NA"</span><span class="op">)</span>  </span>
<span></span>
<span><span class="fu">sjmisc</span><span class="fu">::</span><span class="fu"><a href="https://strengejacke.github.io/sjmisc/reference/frq.html">frq</a></span><span class="op">(</span><span class="va">db_long</span><span class="op">$</span><span class="va">decile1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Income decile with NA (x) &lt;categorical&gt; 
# total N=6204 valid N=6204 mean=5.92 sd=3.13

Value |   N | Raw % | Valid % | Cum. %
--------------------------------------
1     | 576 |  9.28 |    9.28 |   9.28
2     | 576 |  9.28 |    9.28 |  18.57
3     | 574 |  9.25 |    9.25 |  27.82
4     | 573 |  9.24 |    9.24 |  37.06
5     | 571 |  9.20 |    9.20 |  46.26
6     | 571 |  9.20 |    9.20 |  55.46
7     | 570 |  9.19 |    9.19 |  64.65
8     | 570 |  9.19 |    9.19 |  73.84
9     | 570 |  9.19 |    9.19 |  83.03
10    | 570 |  9.19 |    9.19 |  92.21
DNA   | 483 |  7.79 |    7.79 | 100.00
&lt;NA&gt;  |   0 |  0.00 |    &lt;NA&gt; |   &lt;NA&gt;</code></pre>
</div>
</div>
</section><section id="housing" class="level3" data-number="4.3.6"><h3 data-number="4.3.6" class="anchored" data-anchor-id="housing">
<span class="header-section-number">4.3.6</span> Housing</h3>
<div class="cell">
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">frq</span><span class="op">(</span><span class="va">db_long</span><span class="op">$</span><span class="va">m33</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>x &lt;numeric&gt; 
# total N=6204 valid N=3535 mean=2.25 sd=1.69

Value |    N | Raw % | Valid % | Cum. %
---------------------------------------
    1 | 1808 | 29.14 |   51.15 |  51.15
    2 |  493 |  7.95 |   13.95 |  65.09
    3 |  715 | 11.52 |   20.23 |  85.32
    4 |   42 |  0.68 |    1.19 |  86.51
    5 |   90 |  1.45 |    2.55 |  89.05
    6 |  321 |  5.17 |    9.08 |  98.13
    7 |   66 |  1.06 |    1.87 | 100.00
 &lt;NA&gt; | 2669 | 43.02 |    &lt;NA&gt; |   &lt;NA&gt;</code></pre>
</div>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">db_long</span> <span class="op">&lt;-</span> <span class="va">db_long</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    m33_rec <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span></span>
<span>      <span class="va">m33</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="st">"Owned and fully paid-off home"</span>,</span>
<span>      <span class="va">m33</span> <span class="op">==</span> <span class="fl">2</span> <span class="op">~</span> <span class="st">"Owned home with mortgage payments"</span>,</span>
<span>      <span class="va">m33</span> <span class="op">==</span> <span class="fl">3</span> <span class="op">~</span> <span class="st">"A rented home"</span>,</span>
<span>      <span class="va">m33</span> <span class="op">==</span> <span class="fl">4</span> <span class="op">~</span> <span class="st">"A home provided by work or service"</span>,</span>
<span>      <span class="va">m33</span> <span class="op">==</span> <span class="fl">5</span> <span class="op">~</span> <span class="st">"Owned home shared with one or more families"</span>,</span>
<span>      <span class="va">m33</span> <span class="op">==</span> <span class="fl">6</span> <span class="op">~</span> <span class="st">"Home provided by a family member or friend"</span>,</span>
<span>      <span class="va">m33</span> <span class="op">==</span> <span class="fl">7</span> <span class="op">~</span> <span class="st">"Other, please specify"</span>,</span>
<span>      <span class="cn">TRUE</span> <span class="op">~</span> <span class="cn">NA_character_</span></span>
<span>    <span class="op">)</span>,</span>
<span>    m33_rec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">m33_rec</span>,</span>
<span>                     levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Owned and fully paid-off home"</span>,</span>
<span>                                <span class="st">"Owned home with mortgage payments"</span>,</span>
<span>                                <span class="st">"A rented home"</span>,</span>
<span>                                <span class="st">"A home provided by work or service"</span>,</span>
<span>                                <span class="st">"Owned home shared with one or more families"</span>,</span>
<span>                                <span class="st">"Home provided by a family member or friend"</span>,</span>
<span>                                <span class="st">"Other, please specify"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu">frq</span><span class="op">(</span><span class="va">db_long</span><span class="op">$</span><span class="va">m33_rec</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>x &lt;categorical&gt; 
# total N=6204 valid N=3535 mean=2.25 sd=1.69

Value                                       |    N | Raw % | Valid % | Cum. %
-----------------------------------------------------------------------------
Owned and fully paid-off home               | 1808 | 29.14 |   51.15 |  51.15
Owned home with mortgage payments           |  493 |  7.95 |   13.95 |  65.09
A rented home                               |  715 | 11.52 |   20.23 |  85.32
A home provided by work or service          |   42 |  0.68 |    1.19 |  86.51
Owned home shared with one or more families |   90 |  1.45 |    2.55 |  89.05
Home provided by a family member or friend  |  321 |  5.17 |    9.08 |  98.13
Other, please specify                       |   66 |  1.06 |    1.87 | 100.00
&lt;NA&gt;                                        | 2669 | 43.02 |    &lt;NA&gt; |   &lt;NA&gt;</code></pre>
</div>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">db_long</span> <span class="op">&lt;-</span> <span class="va">db_long</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    housing <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span></span>
<span>      <span class="va">m33</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="st">"Owned and fully paid-off home"</span>,</span>
<span>      <span class="va">m33</span> <span class="op">==</span> <span class="fl">2</span> <span class="op">~</span> <span class="st">"Owned home with mortgage payments"</span>,</span>
<span>      <span class="va">m33</span> <span class="op">==</span> <span class="fl">3</span> <span class="op">~</span> <span class="st">"Rented housing"</span>,</span>
<span>      <span class="va">m33</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">6</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Other regime"</span>,</span>
<span>      <span class="cn">TRUE</span> <span class="op">~</span> <span class="cn">NA_character_</span></span>
<span>    <span class="op">)</span>,</span>
<span>    housing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">housing</span>, </span>
<span>                     levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Owned and fully paid-off home"</span>, </span>
<span>                                <span class="st">"Owned home with mortgage payments"</span>,</span>
<span>                                <span class="st">"Rented housing"</span>, </span>
<span>                                <span class="st">"Other regime"</span><span class="op">)</span><span class="op">)</span> </span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu">frq</span><span class="op">(</span><span class="va">db_long</span><span class="op">$</span><span class="va">housing</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>x &lt;categorical&gt; 
# total N=6204 valid N=3469 mean=1.95 sd=1.12

Value                             |    N | Raw % | Valid % | Cum. %
-------------------------------------------------------------------
Owned and fully paid-off home     | 1808 | 29.14 |   52.12 |  52.12
Owned home with mortgage payments |  493 |  7.95 |   14.21 |  66.33
Rented housing                    |  715 | 11.52 |   20.61 |  86.94
Other regime                      |  453 |  7.30 |   13.06 | 100.00
&lt;NA&gt;                              | 2735 | 44.08 |    &lt;NA&gt; |   &lt;NA&gt;</code></pre>
</div>
</div>
<section id="descriptive-analysis-of-housing-variable" class="level4"><h4 class="anchored" data-anchor-id="descriptive-analysis-of-housing-variable">Descriptive analysis of housing variable</h4>
<div class="cell">
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">datos.m33</span> <span class="op">&lt;-</span> <span class="va">db_long</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">idencuesta</span>, <span class="va">ola</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">m33_rec</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">ola</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>porcentaje<span class="op">=</span><span class="va">n</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>ola <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">ola</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"2016"</span>,</span>
<span>                                      <span class="st">"2017"</span>,</span>
<span>                                      <span class="st">"2018"</span>,</span>
<span>                                      <span class="st">"2019"</span>,</span>
<span>                                      <span class="st">"2021"</span>,</span>
<span>                                      <span class="st">"2022"</span>,</span>
<span>                                      <span class="st">"2023"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">etiquetas.m33</span> <span class="op">&lt;-</span> <span class="va">db_long</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">ola</span>, <span class="va">m33_rec</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>count <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">ola</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>porcentaje <span class="op">=</span> <span class="va">count</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>idencuesta <span class="op">=</span> <span class="fl">1</span>,</span>
<span>         ola <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">ola</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"2016"</span>,</span>
<span>                                      <span class="st">"2017"</span>,</span>
<span>                                      <span class="st">"2018"</span>,</span>
<span>                                      <span class="st">"2019"</span>,</span>
<span>                                      <span class="st">"2021"</span>,</span>
<span>                                      <span class="st">"2022"</span>,</span>
<span>                                      <span class="st">"2023"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">datos.m33</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">ola</span>, fill <span class="op">=</span> <span class="va">m33_rec</span>, stratum <span class="op">=</span> <span class="va">m33_rec</span>,</span>
<span>             alluvium <span class="op">=</span> <span class="va">idencuesta</span>, y <span class="op">=</span> <span class="va">porcentaje</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggalluvial</span><span class="fu">::</span><span class="fu"><a href="http://corybrunson.github.io/ggalluvial/reference/geom_flow.html">geom_flow</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.4</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">ggalluvial</span><span class="fu">::</span><span class="fu"><a href="http://corybrunson.github.io/ggalluvial/reference/geom_stratum.html">geom_stratum</a></span><span class="op">(</span>linetype <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/percent_format.html">percent</a></span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">scale_fill_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html">viridis</a></span><span class="op">(</span><span class="fl">7</span>, option <span class="op">=</span> <span class="st">"plasma"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_shadowtext</span><span class="op">(</span>data <span class="op">=</span> <span class="va">etiquetas.m33</span>,</span>
<span>                  <span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">porcentaje</span> <span class="op">&gt;</span> <span class="fl">0</span> , <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/percent_format.html">percent</a></span><span class="op">(</span><span class="va">porcentaje</span>, accuracy <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span>,<span class="st">""</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                  position <span class="op">=</span> <span class="fu">position_stack</span><span class="op">(</span>vjust <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span>,</span>
<span>                  show.legend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  size <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                  color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">'white'</span><span class="op">)</span>,</span>
<span>                  bg.colour<span class="op">=</span><span class="st">'grey30'</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"%"</span>,</span>
<span>       x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>       fill <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>       title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>       caption <span class="op">=</span> <span class="st">"Source: own elaboration with pooled data from ELSOC 2016-2023 (N obs = 3,469; N individuals = 1,364)"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_ggdist</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>        text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="01-prod-prep_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Descriptive for housing</span></span>
<span></span>
<span><span class="va">datos.housing</span> <span class="op">&lt;-</span> <span class="va">db_long</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">idencuesta</span>, <span class="va">ola</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">housing</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">ola</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>porcentaje<span class="op">=</span><span class="va">n</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>ola <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">ola</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"2016"</span>,</span>
<span>                                      <span class="st">"2017"</span>,</span>
<span>                                      <span class="st">"2018"</span>,</span>
<span>                                      <span class="st">"2019"</span>,</span>
<span>                                      <span class="st">"2021"</span>,</span>
<span>                                      <span class="st">"2022"</span>,</span>
<span>                                      <span class="st">"2023"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">etiquetas.housing</span> <span class="op">&lt;-</span> <span class="va">db_long</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">ola</span>, <span class="va">housing</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>count <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">ola</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>porcentaje <span class="op">=</span> <span class="va">count</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>idencuesta <span class="op">=</span> <span class="fl">1</span>,</span>
<span>         ola <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">ola</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"2016"</span>,</span>
<span>                                      <span class="st">"2017"</span>,</span>
<span>                                      <span class="st">"2018"</span>,</span>
<span>                                      <span class="st">"2019"</span>,</span>
<span>                                      <span class="st">"2021"</span>,</span>
<span>                                      <span class="st">"2022"</span>,</span>
<span>                                      <span class="st">"2023"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">datos.housing</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">ola</span>, fill <span class="op">=</span> <span class="va">housing</span>, stratum <span class="op">=</span> <span class="va">housing</span>,</span>
<span>             alluvium <span class="op">=</span> <span class="va">idencuesta</span>, y <span class="op">=</span> <span class="va">porcentaje</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggalluvial</span><span class="fu">::</span><span class="fu"><a href="http://corybrunson.github.io/ggalluvial/reference/geom_flow.html">geom_flow</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.4</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">ggalluvial</span><span class="fu">::</span><span class="fu"><a href="http://corybrunson.github.io/ggalluvial/reference/geom_stratum.html">geom_stratum</a></span><span class="op">(</span>linetype <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/percent_format.html">percent</a></span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">scale_fill_manual</span><span class="op">(</span>values <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#DE4968FF"</span>,<span class="st">"#8C2981FF"</span>,<span class="st">"#3B0F70FF"</span>, <span class="st">"#FDB42FFF"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_shadowtext</span><span class="op">(</span>data <span class="op">=</span> <span class="va">etiquetas.housing</span>,</span>
<span>                  <span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">porcentaje</span> <span class="op">&gt;</span> <span class="fl">0</span> , <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/percent_format.html">percent</a></span><span class="op">(</span><span class="va">porcentaje</span>, accuracy <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span>,<span class="st">""</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                  position <span class="op">=</span> <span class="fu">position_stack</span><span class="op">(</span>vjust <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span>,</span>
<span>                  show.legend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  size <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                  color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">'white'</span><span class="op">)</span>,</span>
<span>                  bg.colour<span class="op">=</span><span class="st">'grey30'</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"%"</span>,</span>
<span>       x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>       fill <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>       title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>       caption <span class="op">=</span> <span class="st">"Source: own elaboration with pooled data from ELSOC 2016-2023 (N obs = 3,469; N individuals = 1,364)"</span><span class="op">)</span><span class="op">+</span></span>
<span>       <span class="fu">theme_ggdist</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>        text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="01-prod-prep_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">datos.housing2</span> <span class="op">&lt;-</span> <span class="va">db_long</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">ola</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2016</span>, <span class="fl">2023</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">idencuesta</span>, <span class="va">ola</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">housing</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">ola</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>porcentaje<span class="op">=</span><span class="va">n</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>ola <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">ola</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"2016"</span>,</span>
<span>                                      <span class="st">"2023"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">etiquetas.housing2</span> <span class="op">&lt;-</span> <span class="va">db_long</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">ola</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2016</span>, <span class="fl">2023</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">ola</span>, <span class="va">housing</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>count <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">ola</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>porcentaje <span class="op">=</span> <span class="va">count</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>idencuesta <span class="op">=</span> <span class="fl">1</span>,</span>
<span>         ola <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">ola</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"2016"</span>,</span>
<span>                                      <span class="st">"2023"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">datos.housing2</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">ola</span>, fill <span class="op">=</span> <span class="va">housing</span>, stratum <span class="op">=</span> <span class="va">housing</span>,</span>
<span>             alluvium <span class="op">=</span> <span class="va">idencuesta</span>, y <span class="op">=</span> <span class="va">porcentaje</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggalluvial</span><span class="fu">::</span><span class="fu"><a href="http://corybrunson.github.io/ggalluvial/reference/geom_flow.html">geom_flow</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.4</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">ggalluvial</span><span class="fu">::</span><span class="fu"><a href="http://corybrunson.github.io/ggalluvial/reference/geom_stratum.html">geom_stratum</a></span><span class="op">(</span>linetype <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/percent_format.html">percent</a></span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">scale_fill_manual</span><span class="op">(</span>values <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#DE4968FF"</span>,<span class="st">"#8C2981FF"</span>,<span class="st">"#3B0F70FF"</span>, <span class="st">"#FDB42FFF"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_shadowtext</span><span class="op">(</span>data <span class="op">=</span> <span class="va">etiquetas.housing2</span>,</span>
<span>                  <span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">porcentaje</span> <span class="op">&gt;</span> <span class="fl">0</span> , <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/percent_format.html">percent</a></span><span class="op">(</span><span class="va">porcentaje</span>, accuracy <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span>,<span class="st">""</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                  position <span class="op">=</span> <span class="fu">position_stack</span><span class="op">(</span>vjust <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span>,</span>
<span>                  show.legend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  size <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                  color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">'white'</span><span class="op">)</span>,</span>
<span>                  bg.colour<span class="op">=</span><span class="st">'grey30'</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"%"</span>,</span>
<span>       x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>       fill <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>       title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>       caption <span class="op">=</span> <span class="st">"Source: own elaboration with pooled data from ELSOC 2016-2023 (N obs = 3,469; N individuals = 1,364)"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_ggdist</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>        text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="01-prod-prep_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">db_long</span>, <span class="va">ola</span> <span class="op">==</span> <span class="fl">2016</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">sjPlot</span><span class="fu">::</span><span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/tab_xtab.html">sjt.xtab</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">sex</span>, </span>
<span>                   <span class="va">df</span><span class="op">$</span><span class="va">housing</span>, </span>
<span>                   show.row.prc <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                   show.col.prc <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                   statistics <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top:double; text-align:center; font-style:italic; font-weight:normal; border-bottom:1px solid;" rowspan="2">sex</th>
 <th style="border-top:double; text-align:center; font-style:italic; font-weight:normal;" colspan="4">housing</th>
 <th style="border-top:double; text-align:center; font-style:italic; font-weight:normal; font-weight:bolder; font-style:italic; border-bottom:1px solid; " rowspan="2">Total</th>
 </tr>
<tr>
<td style="border-bottom:1px solid; text-align:center; padding:0.2cm;">Owned and fully<br>paid-off home</td>
 <td style="border-bottom:1px solid; text-align:center; padding:0.2cm;">Owned home with<br>mortgage payments</td>
 <td style="border-bottom:1px solid; text-align:center; padding:0.2cm;">Rented housing</td>
 <td style="border-bottom:1px solid; text-align:center; padding:0.2cm;">Other regime</td>
 </tr>
<tr>
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">Male</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">163</span><br><span style="color:#333399;">47.8&nbsp;%</span><br><span style="color:#339933;">35.4&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">59</span><br><span style="color:#333399;">17.3&nbsp;%</span><br><span style="color:#339933;">43.4&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">94</span><br><span style="color:#333399;">27.6&nbsp;%</span><br><span style="color:#339933;">44.8&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">25</span><br><span style="color:#333399;">7.3&nbsp;%</span><br><span style="color:#339933;">27.5&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;  ">
<span style="color:black;">341</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">38&nbsp;%</span>
</td> 
</tr>
<tr>
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">Female</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">298</span><br><span style="color:#333399;">53.5&nbsp;%</span><br><span style="color:#339933;">64.6&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">77</span><br><span style="color:#333399;">13.8&nbsp;%</span><br><span style="color:#339933;">56.6&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">116</span><br><span style="color:#333399;">20.8&nbsp;%</span><br><span style="color:#339933;">55.2&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">66</span><br><span style="color:#333399;">11.8&nbsp;%</span><br><span style="color:#339933;">72.5&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;  ">
<span style="color:black;">557</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">62&nbsp;%</span>
</td> 
</tr>
<tr>
<td style="padding:0.2cm;  border-bottom:double; font-weight:bolder; font-style:italic; text-align:left; vertical-align:middle;">Total</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">461</span><br><span style="color:#333399;">51.3&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">136</span><br><span style="color:#333399;">15.1&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">210</span><br><span style="color:#333399;">23.4&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">91</span><br><span style="color:#333399;">10.1&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">898</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td> 
</tr>
<tr><td style="text-align:right; font-size:0.9em; font-style:italic; padding:0.2cm;" colspan="6">χ<sup>2</sup>=11.397 · df=3 · Cramer's V=0.113 · p=0.010</td> 

 
</tr></tbody></table>
</div>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Age_t and housing</span></span>
<span></span>
<span><span class="fu">sjPlot</span><span class="fu">::</span><span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/tab_xtab.html">sjt.xtab</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">age_t</span>, </span>
<span>                 <span class="va">df</span><span class="op">$</span><span class="va">housing</span>, </span>
<span>                 show.row.prc <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                 show.col.prc <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                 statistics <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top:double; text-align:center; font-style:italic; font-weight:normal; border-bottom:1px solid;" rowspan="2">age_t</th>
 <th style="border-top:double; text-align:center; font-style:italic; font-weight:normal;" colspan="4">housing</th>
 <th style="border-top:double; text-align:center; font-style:italic; font-weight:normal; font-weight:bolder; font-style:italic; border-bottom:1px solid; " rowspan="2">Total</th>
 </tr>
<tr>
<td style="border-bottom:1px solid; text-align:center; padding:0.2cm;">Owned and fully<br>paid-off home</td>
 <td style="border-bottom:1px solid; text-align:center; padding:0.2cm;">Owned home with<br>mortgage payments</td>
 <td style="border-bottom:1px solid; text-align:center; padding:0.2cm;">Rented housing</td>
 <td style="border-bottom:1px solid; text-align:center; padding:0.2cm;">Other regime</td>
 </tr>
<tr>
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">18-29</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">61</span><br><span style="color:#333399;">36.7&nbsp;%</span><br><span style="color:#339933;">13.2&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">27</span><br><span style="color:#333399;">16.3&nbsp;%</span><br><span style="color:#339933;">19.9&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">59</span><br><span style="color:#333399;">35.5&nbsp;%</span><br><span style="color:#339933;">28.1&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">19</span><br><span style="color:#333399;">11.4&nbsp;%</span><br><span style="color:#339933;">20.9&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;  ">
<span style="color:black;">166</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">18.5&nbsp;%</span>
</td> 
</tr>
<tr>
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">30-49</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">134</span><br><span style="color:#333399;">36.6&nbsp;%</span><br><span style="color:#339933;">29.1&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">75</span><br><span style="color:#333399;">20.5&nbsp;%</span><br><span style="color:#339933;">55.1&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">119</span><br><span style="color:#333399;">32.5&nbsp;%</span><br><span style="color:#339933;">56.7&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">38</span><br><span style="color:#333399;">10.4&nbsp;%</span><br><span style="color:#339933;">41.8&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;  ">
<span style="color:black;">366</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">40.8&nbsp;%</span>
</td> 
</tr>
<tr>
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">50-64</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">172</span><br><span style="color:#333399;">67.7&nbsp;%</span><br><span style="color:#339933;">37.3&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">30</span><br><span style="color:#333399;">11.8&nbsp;%</span><br><span style="color:#339933;">22.1&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">27</span><br><span style="color:#333399;">10.6&nbsp;%</span><br><span style="color:#339933;">12.9&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">25</span><br><span style="color:#333399;">9.8&nbsp;%</span><br><span style="color:#339933;">27.5&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;  ">
<span style="color:black;">254</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">28.3&nbsp;%</span>
</td> 
</tr>
<tr>
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">65 or more</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">94</span><br><span style="color:#333399;">83.9&nbsp;%</span><br><span style="color:#339933;">20.4&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">4</span><br><span style="color:#333399;">3.6&nbsp;%</span><br><span style="color:#339933;">2.9&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">5</span><br><span style="color:#333399;">4.5&nbsp;%</span><br><span style="color:#339933;">2.4&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">9</span><br><span style="color:#333399;">8&nbsp;%</span><br><span style="color:#339933;">9.9&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;  ">
<span style="color:black;">112</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">12.5&nbsp;%</span>
</td> 
</tr>
<tr>
<td style="padding:0.2cm;  border-bottom:double; font-weight:bolder; font-style:italic; text-align:left; vertical-align:middle;">Total</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">461</span><br><span style="color:#333399;">51.3&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">136</span><br><span style="color:#333399;">15.1&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">210</span><br><span style="color:#333399;">23.4&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">91</span><br><span style="color:#333399;">10.1&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">898</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td> 
</tr>
<tr><td style="text-align:right; font-size:0.9em; font-style:italic; padding:0.2cm;" colspan="6">χ<sup>2</sup>=136.769 · df=9 · Cramer's V=0.225 · p=0.000</td> 

 
</tr></tbody></table>
</div>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Decile and housing</span></span>
<span></span>
<span><span class="fu">sjPlot</span><span class="fu">::</span><span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/tab_xtab.html">sjt.xtab</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">decile</span>, </span>
<span>                 <span class="va">df</span><span class="op">$</span><span class="va">housing</span>, </span>
<span>                 show.row.prc <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                 show.col.prc <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                 statistics <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top:double; text-align:center; font-style:italic; font-weight:normal; border-bottom:1px solid;" rowspan="2">Income decile</th>
 <th style="border-top:double; text-align:center; font-style:italic; font-weight:normal;" colspan="4">housing</th>
 <th style="border-top:double; text-align:center; font-style:italic; font-weight:normal; font-weight:bolder; font-style:italic; border-bottom:1px solid; " rowspan="2">Total</th>
 </tr>
<tr>
<td style="border-bottom:1px solid; text-align:center; padding:0.2cm;">Owned and fully<br>paid-off home</td>
 <td style="border-bottom:1px solid; text-align:center; padding:0.2cm;">Owned home with<br>mortgage payments</td>
 <td style="border-bottom:1px solid; text-align:center; padding:0.2cm;">Rented housing</td>
 <td style="border-bottom:1px solid; text-align:center; padding:0.2cm;">Other regime</td>
 </tr>
<tr>
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">1</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">61</span><br><span style="color:#333399;">70.9&nbsp;%</span><br><span style="color:#339933;">13.7&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">2</span><br><span style="color:#333399;">2.3&nbsp;%</span><br><span style="color:#339933;">1.6&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">16</span><br><span style="color:#333399;">18.6&nbsp;%</span><br><span style="color:#339933;">7.8&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">7</span><br><span style="color:#333399;">8.1&nbsp;%</span><br><span style="color:#339933;">7.9&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;  ">
<span style="color:black;">86</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">9.9&nbsp;%</span>
</td> 
</tr>
<tr>
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">2</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">48</span><br><span style="color:#333399;">56.5&nbsp;%</span><br><span style="color:#339933;">10.8&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">9</span><br><span style="color:#333399;">10.6&nbsp;%</span><br><span style="color:#339933;">7&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">16</span><br><span style="color:#333399;">18.8&nbsp;%</span><br><span style="color:#339933;">7.8&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">12</span><br><span style="color:#333399;">14.1&nbsp;%</span><br><span style="color:#339933;">13.5&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;  ">
<span style="color:black;">85</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">9.8&nbsp;%</span>
</td> 
</tr>
<tr>
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">3</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">42</span><br><span style="color:#333399;">48.3&nbsp;%</span><br><span style="color:#339933;">9.5&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">8</span><br><span style="color:#333399;">9.2&nbsp;%</span><br><span style="color:#339933;">6.2&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">21</span><br><span style="color:#333399;">24.1&nbsp;%</span><br><span style="color:#339933;">10.3&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">16</span><br><span style="color:#333399;">18.4&nbsp;%</span><br><span style="color:#339933;">18&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;  ">
<span style="color:black;">87</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">10&nbsp;%</span>
</td> 
</tr>
<tr>
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">4</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">50</span><br><span style="color:#333399;">57.5&nbsp;%</span><br><span style="color:#339933;">11.3&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">6</span><br><span style="color:#333399;">6.9&nbsp;%</span><br><span style="color:#339933;">4.7&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">19</span><br><span style="color:#333399;">21.8&nbsp;%</span><br><span style="color:#339933;">9.3&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">12</span><br><span style="color:#333399;">13.8&nbsp;%</span><br><span style="color:#339933;">13.5&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;  ">
<span style="color:black;">87</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">10&nbsp;%</span>
</td> 
</tr>
<tr>
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">5</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">50</span><br><span style="color:#333399;">57.5&nbsp;%</span><br><span style="color:#339933;">11.3&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">14</span><br><span style="color:#333399;">16.1&nbsp;%</span><br><span style="color:#339933;">10.9&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">20</span><br><span style="color:#333399;">23&nbsp;%</span><br><span style="color:#339933;">9.8&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">3</span><br><span style="color:#333399;">3.4&nbsp;%</span><br><span style="color:#339933;">3.4&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;  ">
<span style="color:black;">87</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">10&nbsp;%</span>
</td> 
</tr>
<tr>
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">6</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">43</span><br><span style="color:#333399;">50.6&nbsp;%</span><br><span style="color:#339933;">9.7&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">12</span><br><span style="color:#333399;">14.1&nbsp;%</span><br><span style="color:#339933;">9.3&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">21</span><br><span style="color:#333399;">24.7&nbsp;%</span><br><span style="color:#339933;">10.3&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">9</span><br><span style="color:#333399;">10.6&nbsp;%</span><br><span style="color:#339933;">10.1&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;  ">
<span style="color:black;">85</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">9.8&nbsp;%</span>
</td> 
</tr>
<tr>
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">7</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">42</span><br><span style="color:#333399;">47.7&nbsp;%</span><br><span style="color:#339933;">9.5&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">16</span><br><span style="color:#333399;">18.2&nbsp;%</span><br><span style="color:#339933;">12.4&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">21</span><br><span style="color:#333399;">23.9&nbsp;%</span><br><span style="color:#339933;">10.3&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">9</span><br><span style="color:#333399;">10.2&nbsp;%</span><br><span style="color:#339933;">10.1&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;  ">
<span style="color:black;">88</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">10.2&nbsp;%</span>
</td> 
</tr>
<tr>
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">8</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">41</span><br><span style="color:#333399;">48.2&nbsp;%</span><br><span style="color:#339933;">9.2&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">14</span><br><span style="color:#333399;">16.5&nbsp;%</span><br><span style="color:#339933;">10.9&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">22</span><br><span style="color:#333399;">25.9&nbsp;%</span><br><span style="color:#339933;">10.8&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">8</span><br><span style="color:#333399;">9.4&nbsp;%</span><br><span style="color:#339933;">9&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;  ">
<span style="color:black;">85</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">9.8&nbsp;%</span>
</td> 
</tr>
<tr>
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">9</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">34</span><br><span style="color:#333399;">38.6&nbsp;%</span><br><span style="color:#339933;">7.7&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">20</span><br><span style="color:#333399;">22.7&nbsp;%</span><br><span style="color:#339933;">15.5&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">23</span><br><span style="color:#333399;">26.1&nbsp;%</span><br><span style="color:#339933;">11.3&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">11</span><br><span style="color:#333399;">12.5&nbsp;%</span><br><span style="color:#339933;">12.4&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;  ">
<span style="color:black;">88</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">10.2&nbsp;%</span>
</td> 
</tr>
<tr>
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">10</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">33</span><br><span style="color:#333399;">37.5&nbsp;%</span><br><span style="color:#339933;">7.4&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">28</span><br><span style="color:#333399;">31.8&nbsp;%</span><br><span style="color:#339933;">21.7&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">25</span><br><span style="color:#333399;">28.4&nbsp;%</span><br><span style="color:#339933;">12.3&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">2</span><br><span style="color:#333399;">2.3&nbsp;%</span><br><span style="color:#339933;">2.2&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;  ">
<span style="color:black;">88</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">10.2&nbsp;%</span>
</td> 
</tr>
<tr>
<td style="padding:0.2cm;  border-bottom:double; font-weight:bolder; font-style:italic; text-align:left; vertical-align:middle;">Total</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">444</span><br><span style="color:#333399;">51.3&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">129</span><br><span style="color:#333399;">14.9&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">204</span><br><span style="color:#333399;">23.6&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">89</span><br><span style="color:#333399;">10.3&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">866</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td> 
</tr>
<tr><td style="text-align:right; font-size:0.9em; font-style:italic; padding:0.2cm;" colspan="6">χ<sup>2</sup>=73.374 · df=27 · Cramer's V=0.168 · p=0.000</td> 

 
</tr></tbody></table>
</div>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Education and housing</span></span>
<span></span>
<span><span class="fu">sjPlot</span><span class="fu">::</span><span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/tab_xtab.html">sjt.xtab</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">cine</span>, </span>
<span>                 <span class="va">df</span><span class="op">$</span><span class="va">housing</span>, </span>
<span>                 show.row.prc <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                 show.col.prc <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                 statistics <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top:double; text-align:center; font-style:italic; font-weight:normal; border-bottom:1px solid;" rowspan="2">cine</th>
 <th style="border-top:double; text-align:center; font-style:italic; font-weight:normal;" colspan="4">housing</th>
 <th style="border-top:double; text-align:center; font-style:italic; font-weight:normal; font-weight:bolder; font-style:italic; border-bottom:1px solid; " rowspan="2">Total</th>
 </tr>
<tr>
<td style="border-bottom:1px solid; text-align:center; padding:0.2cm;">Owned and fully<br>paid-off home</td>
 <td style="border-bottom:1px solid; text-align:center; padding:0.2cm;">Owned home with<br>mortgage payments</td>
 <td style="border-bottom:1px solid; text-align:center; padding:0.2cm;">Rented housing</td>
 <td style="border-bottom:1px solid; text-align:center; padding:0.2cm;">Other regime</td>
 </tr>
<tr>
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">Primary or less</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">125</span><br><span style="color:#333399;">67.9&nbsp;%</span><br><span style="color:#339933;">27.1&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">13</span><br><span style="color:#333399;">7.1&nbsp;%</span><br><span style="color:#339933;">9.6&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">24</span><br><span style="color:#333399;">13&nbsp;%</span><br><span style="color:#339933;">11.4&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">22</span><br><span style="color:#333399;">12&nbsp;%</span><br><span style="color:#339933;">24.2&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;  ">
<span style="color:black;">184</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">20.5&nbsp;%</span>
</td> 
</tr>
<tr>
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">Secondary</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">180</span><br><span style="color:#333399;">51.9&nbsp;%</span><br><span style="color:#339933;">39&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">41</span><br><span style="color:#333399;">11.8&nbsp;%</span><br><span style="color:#339933;">30.4&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">79</span><br><span style="color:#333399;">22.8&nbsp;%</span><br><span style="color:#339933;">37.6&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">47</span><br><span style="color:#333399;">13.5&nbsp;%</span><br><span style="color:#339933;">51.6&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;  ">
<span style="color:black;">347</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">38.7&nbsp;%</span>
</td> 
</tr>
<tr>
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">Technical</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">70</span><br><span style="color:#333399;">41.4&nbsp;%</span><br><span style="color:#339933;">15.2&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">34</span><br><span style="color:#333399;">20.1&nbsp;%</span><br><span style="color:#339933;">25.2&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">50</span><br><span style="color:#333399;">29.6&nbsp;%</span><br><span style="color:#339933;">23.8&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">15</span><br><span style="color:#333399;">8.9&nbsp;%</span><br><span style="color:#339933;">16.5&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;  ">
<span style="color:black;">169</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">18.8&nbsp;%</span>
</td> 
</tr>
<tr>
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">University or more</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">86</span><br><span style="color:#333399;">43.7&nbsp;%</span><br><span style="color:#339933;">18.7&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">47</span><br><span style="color:#333399;">23.9&nbsp;%</span><br><span style="color:#339933;">34.8&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">57</span><br><span style="color:#333399;">28.9&nbsp;%</span><br><span style="color:#339933;">27.1&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">7</span><br><span style="color:#333399;">3.6&nbsp;%</span><br><span style="color:#339933;">7.7&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;  ">
<span style="color:black;">197</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">22&nbsp;%</span>
</td> 
</tr>
<tr>
<td style="padding:0.2cm;  border-bottom:double; font-weight:bolder; font-style:italic; text-align:left; vertical-align:middle;">Total</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">461</span><br><span style="color:#333399;">51.4&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">135</span><br><span style="color:#333399;">15.1&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">210</span><br><span style="color:#333399;">23.4&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">91</span><br><span style="color:#333399;">10.1&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">897</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td> 
</tr>
<tr><td style="text-align:right; font-size:0.9em; font-style:italic; padding:0.2cm;" colspan="6">χ<sup>2</sup>=65.707 · df=9 · Cramer's V=0.156 · p=0.000</td> 

 
</tr></tbody></table>
</div>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">sjPlot</span><span class="fu">::</span><span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/tab_xtab.html">sjt.xtab</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">educ_dic</span>, </span>
<span>                 <span class="va">df</span><span class="op">$</span><span class="va">housing</span>, </span>
<span>                 show.row.prc <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                 show.col.prc <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                 statistics <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top:double; text-align:center; font-style:italic; font-weight:normal; border-bottom:1px solid;" rowspan="2">educ_dic</th>
 <th style="border-top:double; text-align:center; font-style:italic; font-weight:normal;" colspan="4">housing</th>
 <th style="border-top:double; text-align:center; font-style:italic; font-weight:normal; font-weight:bolder; font-style:italic; border-bottom:1px solid; " rowspan="2">Total</th>
 </tr>
<tr>
<td style="border-bottom:1px solid; text-align:center; padding:0.2cm;">Owned and fully<br>paid-off home</td>
 <td style="border-bottom:1px solid; text-align:center; padding:0.2cm;">Owned home with<br>mortgage payments</td>
 <td style="border-bottom:1px solid; text-align:center; padding:0.2cm;">Rented housing</td>
 <td style="border-bottom:1px solid; text-align:center; padding:0.2cm;">Other regime</td>
 </tr>
<tr>
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">Less than<br>Universitary</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">375</span><br><span style="color:#333399;">53.6&nbsp;%</span><br><span style="color:#339933;">81.3&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">88</span><br><span style="color:#333399;">12.6&nbsp;%</span><br><span style="color:#339933;">65.2&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">153</span><br><span style="color:#333399;">21.9&nbsp;%</span><br><span style="color:#339933;">72.9&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">84</span><br><span style="color:#333399;">12&nbsp;%</span><br><span style="color:#339933;">92.3&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;  ">
<span style="color:black;">700</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">78&nbsp;%</span>
</td> 
</tr>
<tr>
<td style="padding:0.2cm;  text-align:left; vertical-align:middle;">Universitary</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">86</span><br><span style="color:#333399;">43.7&nbsp;%</span><br><span style="color:#339933;">18.7&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">47</span><br><span style="color:#333399;">23.9&nbsp;%</span><br><span style="color:#339933;">34.8&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">57</span><br><span style="color:#333399;">28.9&nbsp;%</span><br><span style="color:#339933;">27.1&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center; ">
<span style="color:black;">7</span><br><span style="color:#333399;">3.6&nbsp;%</span><br><span style="color:#339933;">7.7&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;  ">
<span style="color:black;">197</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">22&nbsp;%</span>
</td> 
</tr>
<tr>
<td style="padding:0.2cm;  border-bottom:double; font-weight:bolder; font-style:italic; text-align:left; vertical-align:middle;">Total</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">461</span><br><span style="color:#333399;">51.4&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">135</span><br><span style="color:#333399;">15.1&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">210</span><br><span style="color:#333399;">23.4&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">91</span><br><span style="color:#333399;">10.1&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td>
<td style="padding:0.2cm; text-align:center;   border-bottom:double;">
<span style="color:black;">897</span><br><span style="color:#333399;">100&nbsp;%</span><br><span style="color:#339933;">100&nbsp;%</span>
</td> 
</tr>
<tr><td style="text-align:right; font-size:0.9em; font-style:italic; padding:0.2cm;" colspan="6">χ<sup>2</sup>=30.054 · df=3 · Cramer's V=0.183 · p=0.000</td> 

 
</tr></tbody></table>
</div>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">housing</span>, <span class="va">educyear</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">housing</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>educ <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">educyear</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  housing                            educ
  &lt;fct&gt;                             &lt;dbl&gt;
1 Owned and fully paid-off home     11.1 
2 Owned home with mortgage payments 13.4 
3 Rented housing                    12.8 
4 Other regime                      10.9 
5 &lt;NA&gt;                               9.51</code></pre>
</div>
</div>
</section></section></section><section id="missing-values" class="level2" data-number="4.4"><h2 data-number="4.4" class="anchored" data-anchor-id="missing-values">
<span class="header-section-number">4.4</span> Missing values</h2>
<p>Not for now.</p>
</section></section><section id="merge-data-sets" class="level1" data-number="5"><h1 data-number="5">
<span class="header-section-number">5</span> Merge data sets</h1>
<div class="cell">
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">glimpse</span><span class="op">(</span><span class="va">db_long</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 6,204
Columns: 41
$ idencuesta            &lt;dbl&gt; 13101025, 13101025, 13101025, 13101025, 13101025…
$ muestra               &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
$ ola                   &lt;int&gt; 2016, 2017, 2018, 2019, 2022, 2023, 2016, 2017, …
$ tipo_atricion         &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, …
$ segmento              &lt;dbl&gt; 1310102, 1310102, 1310102, 1310102, 1310102, 131…
$ estrato               &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
$ ponderador_long_total &lt;dbl&gt; 3.244167, 1.151845, 1.398911, 1.148530, 1.410670…
$ ponderador01          &lt;dbl&gt; 3.8850000, 3.3065853, 0.5156121, 0.6878372, 0.55…
$ ponderador02          &lt;dbl&gt; 3.1389999, 2.5880983, 0.3958864, 0.5290412, 0.40…
$ comuna                &lt;chr&gt; "Santiago", "Santiago", "Santiago", "Santiago", …
$ comuna_cod            &lt;dbl&gt; 13101, 13101, 13101, 13101, 13101, 13101, 13101,…
$ region                &lt;chr&gt; "Metropolitana de santiago", "Metropolitana de s…
$ region_cod            &lt;dbl&gt; 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, …
$ m0_sexo               &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
$ m0_edad               &lt;dbl&gt; 40, 41, 42, 44, 46, 47, 27, 29, 31, 33, 34, 35, …
$ m01                   &lt;dbl&gt; 9, 9, 9, 9, 9, 9, 7, 1, 1, 2, 2, 2, 3, 9, 9, 9, …
$ nhogar1               &lt;dbl&gt; 1, NA, NA, NA, NA, NA, 1, NA, NA, NA, NA, NA, NA…
$ m46_nhogar            &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 2, NA, NA, NA, NA, N…
$ m54                   &lt;dbl&gt; NA, NA, 1, 1, 1, 1, NA, NA, 2, 2, 5, 2, 2, NA, N…
$ m30                   &lt;dbl&gt; NA, NA, NA, NA, NA, 19, NA, NA, NA, NA, NA, NA, …
$ m30b                  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
$ m29                   &lt;dbl&gt; 970000, 1000000, 1000000, 1150000, 1700000, 1900…
$ m33                   &lt;dbl&gt; 3, NA, 3, NA, NA, 3, 3, NA, 3, NA, 6, NA, 3, 3, …
$ sex                   &lt;fct&gt; Female, Female, Female, Female, Female, Female, …
$ age                   &lt;dbl&gt; 40, 41, 42, 44, 46, 47, 27, 29, 31, 33, 34, 35, …
$ age_t                 &lt;fct&gt; 30-49, 30-49, 30-49, 30-49, 30-49, 30-49, 18-29,…
$ cine                  &lt;fct&gt; University or more, University or more, Universi…
$ educ_dic              &lt;fct&gt; Universitary, Universitary, Universitary, Univer…
$ educyear              &lt;dbl&gt; 16.9, 16.9, 16.9, 16.9, 16.9, 16.9, 14.8, 0.0, 0…
$ m30_rec               &lt;dbl&gt; NA, NA, NA, NA, NA, 2275000, NA, NA, NA, NA, NA,…
$ m30b_rec              &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
$ m29_rec               &lt;dbl&gt; 970000, 1000000, 1000000, 1150000, 1700000, 1900…
$ m29_imp               &lt;dbl&gt; 970000, 1000000, 1000000, 1150000, 1700000, 1900…
$ ipc                   &lt;dbl&gt; 72.29, 73.93, 75.83, 78.10, 97.21, 101.04, 72.29…
$ n_hogar               &lt;dbl&gt; 1, NA, 1, 1, 1, 1, 1, 2, 2, 2, 5, 2, 2, 1, 1, 2,…
$ n_hogar_r             &lt;dbl&gt; 1, NA, 1, 1, 1, 1, 1, 2, 2, 2, 5, 2, 2, 1, 1, 2,…
$ ing_pc                &lt;dbl&gt; 970000.0, NA, 1000000.0, 1150000.0, 1700000.0, 1…
$ decile                &lt;int&gt; 10, NA, 10, 10, 10, 10, 9, 3, 6, 1, NA, 8, 6, 10…
$ decile1               &lt;fct&gt; 10, DNA, 10, 10, 10, 10, 9, 3, 6, 1, DNA, 8, 6, …
$ m33_rec               &lt;fct&gt; "A rented home", NA, "A rented home", NA, NA, "A…
$ housing               &lt;fct&gt; Rented housing, NA, Rented housing, NA, NA, Rent…</code></pre>
</div>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">glimpse</span><span class="op">(</span><span class="va">geo_elsoc</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 12,656
Columns: 6
$ base          &lt;chr&gt; "2016", "2016", "2016", "2016", "2016", "2016", "2016", …
$ idencuesta    &lt;chr&gt; "10101053", "10101043", "10101073", "10101032", "1010118…
$ cod_comuna    &lt;chr&gt; "10101", "10101", "10101", "10101", "10101", "10101", "1…
$ geocodigo     &lt;chr&gt; "10101031005", "10101031003", "10101031010", "1010103100…
$ manzana_elsoc &lt;chr&gt; "10101031005045", "10101031003040", "10101031010033", "1…
$ tipo_zona     &lt;chr&gt; "zonas urbanas", "zonas urbanas", "zonas urbanas", "zona…</code></pre>
</div>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">glimpse</span><span class="op">(</span><span class="va">precios_suelo</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,865
Columns: 11
$ ïfid    &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18,…
$ region  &lt;dbl&gt; 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13…
$ nom_rgn &lt;chr&gt; "REGIÃ\u0093N METROPOLITANA DE SANTIAGO", "REGIÃ\u0093N METROP…
$ provinc &lt;dbl&gt; 131, 134, 134, 131, 134, 131, 131, 131, 131, 131, 131, 131, 13…
$ nm_prvn &lt;chr&gt; "SANTIAGO", "MAIPO", "MAIPO", "SANTIAGO", "MAIPO", "SANTIAGO",…
$ comuna  &lt;dbl&gt; 13107, 13402, 13402, 13107, 13402, 13107, 13114, 13115, 13115,…
$ nom_cmn &lt;chr&gt; "HUECHURABA", "BUIN", "BUIN", "HUECHURABA", "BUIN", "HUECHURAB…
$ urbano  &lt;chr&gt; "HUECHURABA", "EL RULO", "ALTO JAHUEL", "HUECHURABA", "BUIN", …
$ geocodg &lt;dbl&gt; 13107011001, 13402061001, 13402021001, 13107021003, 1340201101…
$ redcode &lt;dbl&gt; 13107011001, 13402061001, 13402021001, 13107021003, 1340201101…
$ uf2018  &lt;dbl&gt; 17.260151, 18.538494, 18.648796, 10.132773, 17.914762, 13.3103…</code></pre>
</div>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">precios_suelo</span> <span class="op">&lt;-</span> <span class="va">precios_suelo</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">comuna</span>,</span>
<span>         <span class="va">geocodg</span>,</span>
<span>         <span class="va">uf2018</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>comuna <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">comuna</span><span class="op">)</span>,</span>
<span>         geocodg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">geocodg</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">geo_merge</span> <span class="op">&lt;-</span> <span class="fu">left_join</span><span class="op">(</span><span class="va">geo_elsoc</span>, </span>
<span>          <span class="va">precios_suelo</span>,</span>
<span>          by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cod_comuna"</span> <span class="op">=</span> <span class="st">"comuna"</span>, <span class="st">"geocodigo"</span> <span class="op">=</span> <span class="st">"geocodg"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">geo_merge</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         base    idencuesta    cod_comuna     geocodigo manzana_elsoc 
            0             0             0             0             0 
    tipo_zona        uf2018 
            0          8965 </code></pre>
</div>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">geo_merge</span> <span class="op">&lt;-</span> <span class="va">geo_merge</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">drop_na</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>base <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="va">base</span><span class="op">)</span>,</span>
<span>         idencuesta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">idencuesta</span><span class="op">)</span>,</span>
<span>         cod_comuna <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">cod_comuna</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">frq</span><span class="op">(</span><span class="va">geo_merge</span><span class="op">$</span><span class="va">base</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>x &lt;integer&gt; 
# total N=3691 valid N=3691 mean=2017.57 sd=1.12

Value |    N | Raw % | Valid % | Cum. %
---------------------------------------
 2016 |  900 | 24.38 |   24.38 |  24.38
 2017 |  750 | 20.32 |   20.32 |  44.70
 2018 | 1072 | 29.04 |   29.04 |  73.75
 2019 |  969 | 26.25 |   26.25 | 100.00
 &lt;NA&gt; |    0 |  0.00 |    &lt;NA&gt; |   &lt;NA&gt;</code></pre>
</div>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">db_long_merge</span> <span class="op">&lt;-</span> <span class="fu">left_join</span><span class="op">(</span><span class="va">db_long</span>, <span class="va">geo_merge</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"idencuesta"</span> <span class="op">=</span> <span class="st">"idencuesta"</span>, </span>
<span>                                     <span class="st">"ola"</span> <span class="op">=</span> <span class="st">"base"</span>, </span>
<span>                                     <span class="st">"comuna_cod"</span> <span class="op">=</span> <span class="st">"cod_comuna"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">glimpse</span><span class="op">(</span><span class="va">db_long_merge</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 6,204
Columns: 45
$ idencuesta            &lt;dbl&gt; 13101025, 13101025, 13101025, 13101025, 13101025…
$ muestra               &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
$ ola                   &lt;int&gt; 2016, 2017, 2018, 2019, 2022, 2023, 2016, 2017, …
$ tipo_atricion         &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, …
$ segmento              &lt;dbl&gt; 1310102, 1310102, 1310102, 1310102, 1310102, 131…
$ estrato               &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
$ ponderador_long_total &lt;dbl&gt; 3.244167, 1.151845, 1.398911, 1.148530, 1.410670…
$ ponderador01          &lt;dbl&gt; 3.8850000, 3.3065853, 0.5156121, 0.6878372, 0.55…
$ ponderador02          &lt;dbl&gt; 3.1389999, 2.5880983, 0.3958864, 0.5290412, 0.40…
$ comuna                &lt;chr&gt; "Santiago", "Santiago", "Santiago", "Santiago", …
$ comuna_cod            &lt;dbl&gt; 13101, 13101, 13101, 13101, 13101, 13101, 13101,…
$ region                &lt;chr&gt; "Metropolitana de santiago", "Metropolitana de s…
$ region_cod            &lt;dbl&gt; 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, …
$ m0_sexo               &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
$ m0_edad               &lt;dbl&gt; 40, 41, 42, 44, 46, 47, 27, 29, 31, 33, 34, 35, …
$ m01                   &lt;dbl&gt; 9, 9, 9, 9, 9, 9, 7, 1, 1, 2, 2, 2, 3, 9, 9, 9, …
$ nhogar1               &lt;dbl&gt; 1, NA, NA, NA, NA, NA, 1, NA, NA, NA, NA, NA, NA…
$ m46_nhogar            &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 2, NA, NA, NA, NA, N…
$ m54                   &lt;dbl&gt; NA, NA, 1, 1, 1, 1, NA, NA, 2, 2, 5, 2, 2, NA, N…
$ m30                   &lt;dbl&gt; NA, NA, NA, NA, NA, 19, NA, NA, NA, NA, NA, NA, …
$ m30b                  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
$ m29                   &lt;dbl&gt; 970000, 1000000, 1000000, 1150000, 1700000, 1900…
$ m33                   &lt;dbl&gt; 3, NA, 3, NA, NA, 3, 3, NA, 3, NA, 6, NA, 3, 3, …
$ sex                   &lt;fct&gt; Female, Female, Female, Female, Female, Female, …
$ age                   &lt;dbl&gt; 40, 41, 42, 44, 46, 47, 27, 29, 31, 33, 34, 35, …
$ age_t                 &lt;fct&gt; 30-49, 30-49, 30-49, 30-49, 30-49, 30-49, 18-29,…
$ cine                  &lt;fct&gt; University or more, University or more, Universi…
$ educ_dic              &lt;fct&gt; Universitary, Universitary, Universitary, Univer…
$ educyear              &lt;dbl&gt; 16.9, 16.9, 16.9, 16.9, 16.9, 16.9, 14.8, 0.0, 0…
$ m30_rec               &lt;dbl&gt; NA, NA, NA, NA, NA, 2275000, NA, NA, NA, NA, NA,…
$ m30b_rec              &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
$ m29_rec               &lt;dbl&gt; 970000, 1000000, 1000000, 1150000, 1700000, 1900…
$ m29_imp               &lt;dbl&gt; 970000, 1000000, 1000000, 1150000, 1700000, 1900…
$ ipc                   &lt;dbl&gt; 72.29, 73.93, 75.83, 78.10, 97.21, 101.04, 72.29…
$ n_hogar               &lt;dbl&gt; 1, NA, 1, 1, 1, 1, 1, 2, 2, 2, 5, 2, 2, 1, 1, 2,…
$ n_hogar_r             &lt;dbl&gt; 1, NA, 1, 1, 1, 1, 1, 2, 2, 2, 5, 2, 2, 1, 1, 2,…
$ ing_pc                &lt;dbl&gt; 970000.0, NA, 1000000.0, 1150000.0, 1700000.0, 1…
$ decile                &lt;int&gt; 10, NA, 10, 10, 10, 10, 9, 3, 6, 1, NA, 8, 6, 10…
$ decile1               &lt;fct&gt; 10, DNA, 10, 10, 10, 10, 9, 3, 6, 1, DNA, 8, 6, …
$ m33_rec               &lt;fct&gt; "A rented home", NA, "A rented home", NA, NA, "A…
$ housing               &lt;fct&gt; Rented housing, NA, Rented housing, NA, NA, Rent…
$ geocodigo             &lt;chr&gt; "13101021006", "13101021006", "13101021006", "13…
$ manzana_elsoc         &lt;chr&gt; "13101021004006", "13101021004006", "13101021004…
$ tipo_zona             &lt;chr&gt; "zonas urbanas", "zonas urbanas", "zonas urbanas…
$ uf2018                &lt;dbl&gt; 31.54706, 31.54706, 31.54706, 31.54706, NA, NA, …</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df_study1</span> <span class="op">&lt;-</span> <span class="va">db_long_merge</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">ola</span> <span class="op">&lt;=</span> <span class="fl">2019</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">idencuesta</span>, <span class="va">ola</span>, <span class="va">segmento</span>, <span class="va">estrato</span>, <span class="va">ponderador_long_total</span>, <span class="va">comuna</span>,</span>
<span>         <span class="va">comuna_cod</span>, <span class="va">sex</span>, <span class="va">age</span>, <span class="va">age_t</span>, <span class="va">cine</span>, <span class="va">educ_dic</span>, <span class="va">educyear</span>, <span class="va">decile</span>, <span class="va">decile1</span>,</span>
<span>         <span class="va">housing</span>, <span class="va">geocodigo</span>, <span class="va">manzana_elsoc</span>, <span class="va">tipo_zona</span>, <span class="va">uf2018</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu">glimpse</span><span class="op">(</span><span class="va">df_study1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 3,751
Columns: 20
$ idencuesta            &lt;dbl&gt; 13101025, 13101025, 13101025, 13101025, 13101034…
$ ola                   &lt;int&gt; 2016, 2017, 2018, 2019, 2016, 2017, 2018, 2019, …
$ segmento              &lt;dbl&gt; 1310102, 1310102, 1310102, 1310102, 1310103, 131…
$ estrato               &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
$ ponderador_long_total &lt;dbl&gt; 3.244167, 1.151845, 1.398911, 1.148530, 4.904570…
$ comuna                &lt;chr&gt; "Santiago", "Santiago", "Santiago", "Santiago", …
$ comuna_cod            &lt;dbl&gt; 13101, 13101, 13101, 13101, 13101, 13101, 13101,…
$ sex                   &lt;fct&gt; Female, Female, Female, Female, Male, Male, Male…
$ age                   &lt;dbl&gt; 40, 41, 42, 44, 27, 29, 31, 33, 53, 30, 31, 32, …
$ age_t                 &lt;fct&gt; 30-49, 30-49, 30-49, 30-49, 18-29, 18-29, 30-49,…
$ cine                  &lt;fct&gt; University or more, University or more, Universi…
$ educ_dic              &lt;fct&gt; Universitary, Universitary, Universitary, Univer…
$ educyear              &lt;dbl&gt; 16.90, 16.90, 16.90, 16.90, 14.80, 0.00, 0.00, 4…
$ decile                &lt;int&gt; 10, NA, 10, 10, 9, 3, 6, 1, 10, 10, 8, 9, 9, 9, …
$ decile1               &lt;fct&gt; 10, DNA, 10, 10, 9, 3, 6, 1, 10, 10, 8, 9, 9, 9,…
$ housing               &lt;fct&gt; Rented housing, NA, Rented housing, NA, Rented h…
$ geocodigo             &lt;chr&gt; "13101021006", "13101021006", "13101021006", "13…
$ manzana_elsoc         &lt;chr&gt; "13101021004006", "13101021004006", "13101021004…
$ tipo_zona             &lt;chr&gt; "zonas urbanas", "zonas urbanas", "zonas urbanas…
$ uf2018                &lt;dbl&gt; 31.54706, 31.54706, 31.54706, 31.54706, 25.39937…</code></pre>
</div>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">frq</span><span class="op">(</span><span class="va">df_study1</span><span class="op">$</span><span class="va">ola</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>x &lt;integer&gt; 
# total N=3751 valid N=3751 mean=2017.57 sd=1.12

Value |    N | Raw % | Valid % | Cum. %
---------------------------------------
 2016 |  914 | 24.37 |   24.37 |  24.37
 2017 |  762 | 20.31 |   20.31 |  44.68
 2018 | 1090 | 29.06 |   29.06 |  73.74
 2019 |  985 | 26.26 |   26.26 | 100.00
 &lt;NA&gt; |    0 |  0.00 |    &lt;NA&gt; |   &lt;NA&gt;</code></pre>
</div>
</div>
</section><section id="save-and-export" class="level1" data-number="6"><h1 data-number="6">
<span class="header-section-number">6</span> Save and export</h1>
</section></main><!-- /main column --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->



</body></html>